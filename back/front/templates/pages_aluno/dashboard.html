<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>√Årea do Aluno | Instituto Franciscani</title>
    <link rel="shortcut icon" href="/static/img/logo_if_icon.png" type="" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      :root {
        --primary-color: #00005e;
        --secondary-color: #010146;
        --accent-color: #08083a;
        --light-color: #f8f9fa;
        --dark-color: #212529;
        --success-color: #00b451;
        --warning-color: #f72548;
        --gray-color: #adb5bd;
        --sidebar-width: 250px;
        --header-height: 70px;
        --transition: all 0.3s ease;
        --info-color: #4895ef;
      }

      body {
        background-color: #f5f7fb;
        color: var(--dark-color);
        min-height: 100vh;
      }

      /* Header simplificado apenas com logo */
      .header-simple {
        background: linear-gradient(
          to right,
          var(--primary-color),
          var(--secondary-color)
        );
        padding: 15px 25px;
        display: flex;
        align-items: center;
        justify-content: space-between;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .header-simple img {
        height: 40px;
      }



      .logout-icon {
        color: white;
        font-size: 20px;
        cursor: pointer;
        transition: var(--transition);
      }

      /* Main Content */
      .main-content {
        padding: 20px;
        max-width: 1400px;
        margin: 0 auto;
      }

      /* Perfil do Aluno */
      .student-profile {
        background-color: white;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        margin-bottom: 25px;
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .student-avatar {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(
          to right,
          var(--accent-color),
          var(--primary-color)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 32px;
        flex-shrink: 0;
      }

      .student-avatar img {
        width: 100%;
        height: 100%;
        border-radius: 50%;
        object-fit: cover;
      }

      .student-details {
        flex: 1;
      }

      .student-details h2 {
        color: var(--primary-color);
        margin-bottom: 5px;
      }

      .student-category {
        display: inline-block;
        background-color: var(--primary-color);
        color: white;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 14px;
        margin-right: 10px;
        margin-bottom: 10px;
      }

      .student-sport {
        display: inline-block;
        background-color: var(--info-color);
        color: white;
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 14px;
        margin-bottom: 10px;
      }

      /* Dashboard Grid */
      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(12, 1fr);
        gap: 25px;
        margin-bottom: 25px;
      }

      .card {
        background-color: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .card h3 {
        color: var(--primary-color);
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .card h3 i {
        color: var(--primary-color);
      }

      /* Feedback */
      .feedback-content {
        background-color: #f9f9f9;
        padding: 15px;
        border-radius: 8px;
        border-left: 4px solid var(--primary-color);
      }

      .feedback-coach {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-top: 15px;
      }

      .coach-avatar {
        width: 35px;
        height: 35px;
        border-radius: 50%;
        background-color: var(--accent-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
      }

      .coach-info h4 {
        font-size: 14px;
        margin-bottom: 2px;
      }

      .coach-info p {
        color: var(--gray-color);
        font-size: 12px;
      }

      /* V√≠deos */
      .videos-grid {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 15px;
      }

      .video-item {
        background-color: #f5f7fb;
        border-radius: 8px;
        overflow: hidden;
        transition: var(--transition);
        cursor: pointer;
      }

      .video-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      }

      .video-thumbnail {
        height: 120px;
        background-color: var(--primary-color);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 30px;
      }

      .video-info {
        padding: 10px;
      }

      .video-info h4 {
        font-size: 14px;
        margin-bottom: 5px;
      }

      .video-info p {
        color: var(--gray-color);
        font-size: 12px;
      }

      .video-datetime {
        color: #888;
        font-size: 10px;
        margin-top: 2px;
        font-family: 'Courier New', monospace;
      }

      /* Competi√ß√µes */
      .competition-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .competition-item:last-child {
        border-bottom: none;
      }

      .competition-date {
        background-color: #f5f7fb;
        padding: 10px;
        border-radius: 8px;
        text-align: center;
        min-width: 60px;
      }

      .competition-date .day {
        font-size: 20px;
        font-weight: 700;
        color: var(--primary-color);
      }

      .competition-date .month {
        font-size: 12px;
        color: var(--gray-color);
      }

      .competition-details h4 {
        margin-bottom: 5px;
        font-size: 16px;
      }

      .competition-details p {
        color: var(--gray-color);
        font-size: 13px;
      }

      /* Dieta */
      .diet-button {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          to right,
          var(--primary-color),
          var(--accent-color)
        );
        color: white;
        cursor: pointer;
        transition: var(--transition);
        padding: 25px;
        border-radius: 12px;
        text-align: center;
        height: 100%;
      }

      .diet-button:hover {
        transform: translateY(-3px);
        box-shadow: 0 5px 15px rgba(0, 0, 94, 0.3);
      }

      .diet-button i {
        font-size: 42px;
        margin-bottom: 15px;
      }

      .diet-button h3 {
        font-size: 20px;
        margin-bottom: 10px;
        color: white;
        border: none;
        padding: 0;
        justify-content: center;
      }

      .diet-button p {
        opacity: 0.9;
        margin: 0;
      }

             /* Desempenho */
       .chart-container {
         height: 250px;
         margin-top: 15px;
       }

      /* Atividades */
      .activities-list {
        list-style: none;
      }
      
      /* Treinamentos Recentes */
      .treinamentos-recentes {
        margin-top: 15px;
      }
      
      .treino-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
      }
      
      .treino-item:last-child {
        border-bottom: none;
      }
      
      .treino-data {
        font-weight: bold;
        color: var(--primary-color);
      }
      
      .treino-tipo {
        color: var(--dark-color);
      }
      
      .treino-duracao {
        color: var(--gray-color);
        font-size: 12px;
      }
      
      .treino-status.completado {
        color: var(--success-color);
      }
      
      .treino-status.pendente {
        color: var(--warning-color);
      }
      
      /* Eventos Pr√≥ximos */
      .eventos-proximos {
        margin-top: 15px;
      }
      
      .evento-item {
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
      }
      
      .evento-item:last-child {
        border-bottom: none;
      }
      
      .evento-data {
        font-weight: bold;
        color: var(--primary-color);
        font-size: 14px;
        margin-bottom: 5px;
      }
      
      .evento-titulo {
        font-weight: bold;
        color: var(--dark-color);
        margin-bottom: 3px;
      }
      
      .evento-local {
        color: var(--gray-color);
        font-size: 12px;
      }
      
             .evento-hora {
         color: var(--gray-color);
         font-size: 12px;
         margin-top: 3px;
       }
       
       /* Mensagens de "sem dados" */
       .sem-dados {
         text-align: center;
         padding: 30px 20px;
         color: var(--gray-color);
       }
       
       .sem-dados i {
         font-size: 48px;
         margin-bottom: 15px;
         opacity: 0.5;
       }
       
       .sem-dados p {
         font-size: 16px;
         margin-bottom: 8px;
         color: var(--dark-color);
       }
       
       .sem-dados small {
         font-size: 12px;
         opacity: 0.7;
       }
 
       .activity-item {
        padding: 10px 0;
        border-bottom: 1px solid #f0f0f0;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .activity-item:last-child {
        border-bottom: none;
      }

      .activity-item i {
        color: var(--primary-color);
        width: 20px;
      }

      .activity-date {
        margin-left: auto;
        color: var(--gray-color);
        font-size: 12px;
      }

      /* Feedback do Treinador */
      .feedback-content {
        padding: 0;
        margin-top: 15px;
      }

      .feedback-placeholder {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid var(--primary-color);
        margin-bottom: 15px;
      }

      .feedback-icon {
        width: 40px;
        height: 40px;
        background: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 16px;
        flex-shrink: 0;
      }

      .feedback-text h4 {
        color: var(--dark-color);
        margin-bottom: 8px;
        font-size: 16px;
        font-weight: 600;
      }

      .feedback-text p {
        color: var(--gray-color);
        font-size: 14px;
        line-height: 1.5;
        margin: 0;
      }

      .feedback-trainer {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 0;
        background: transparent;
        border: none;
        box-shadow: none;
        margin: 0;
      }

      .trainer-avatar {
        width: 40px;
        height: 40px;
        background: var(--primary-color);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 14px;
        flex-shrink: 0;
      }

      .trainer-info h4 {
        color: var(--dark-color);
        margin-bottom: 5px;
        font-size: 16px;
        font-weight: 600;
      }

      .trainer-info p {
        color: var(--gray-color);
        font-size: 14px;
        line-height: 1.5;
        background: #f8f9fa;
        padding: 12px;
        border-radius: 8px;
        border-left: 3px solid var(--primary-color);
        margin: 0;
      }

      /* Calend√°rio */
      .calendar {
        margin-top: 15px;
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .calendar-header h4 {
        color: var(--primary-color);
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 5px;
      }

      .calendar-day {
        height: 30px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
        border-radius: 50%;
      }

      .calendar-day.header {
        font-weight: bold;
        color: var(--primary-color);
        border-radius: 0;
      }

      .calendar-day.today {
        background-color: var(--primary-color);
        color: white;
      }

      .calendar-day.has-activity {
        position: relative;
      }

      .calendar-day.has-activity::after {
        content: "";
        position: absolute;
        bottom: 2px;
        left: 50%;
        transform: translateX(-50%);
        width: 4px;
        height: 4px;
        background-color: var(--warning-color);
        border-radius: 50%;
      }
      
      /* Estilos para navega√ß√£o do calend√°rio */
      .calendar-navigation {
        display: flex;
        gap: 10px;
        align-items: center;
      }
      
      .nav-btn {
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 50%;
        width: 30px;
        height: 30px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: var(--transition);
      }
      
      .nav-btn:hover {
        background: var(--secondary-color);
      }
      
      /* Estilos para loading */
      .loading-activities,
      .loading-calendar {
        text-align: center;
        padding: 20px;
        color: var(--gray-color);
      }
      
      .loading-activities i,
      .loading-calendar i {
        font-size: 24px;
        margin-bottom: 10px;
        color: var(--primary-color);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background-color: white;
        width: 500px;
        max-width: 90%;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .modal-header h2 {
        color: var(--primary-color);
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--gray-color);
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        margin-top: 20px;
      }

      .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
      }

      .btn-primary {
        background-color: var(--primary-color);
        color: white;
      }

      .btn-primary:hover {
        background-color: var(--secondary-color);
      }

      .btn-outline {
        background-color: transparent;
        border: 1px solid #ddd;
      }

      .btn-outline:hover {
        background-color: #f5f7fb;
      }

      /* Responsividade */
      @media (max-width: 1200px) {
        .dashboard-grid {
          grid-template-columns: repeat(6, 1fr);
        }

        .card.feedback {
          grid-column: span 6;
        }

        .card.videos {
          grid-column: span 3;
        }

        .card.competitions {
          grid-column: span 3;
        }

        .card.diet {
          grid-column: span 2;
        }

        .card.performance {
          grid-column: span 4;
        }

        .card.activities {
          grid-column: span 3;
        }

        .card.calendar {
          grid-column: span 3;
        }
      }

      @media (max-width: 992px) {
        .dashboard-grid {
          grid-template-columns: repeat(1, 1fr);
        }

        .card {
          grid-column: span 1 !important;
        }

        .videos-grid {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .student-profile {
          flex-direction: column;
          text-align: center;
        }

        .calendar-grid {
          gap: 2px;
        }

        .calendar-day {
          height: 25px;
          font-size: 10px;
        }
      }

      /* Estilos para mensagem de v√≠deos vazios */
      .no-videos {
        text-align: center;
        padding: 40px 20px;
        color: #666;
        grid-column: 1 / -1;
      }

      .no-videos i {
        font-size: 48px;
        color: #ccc;
        margin-bottom: 15px;
        display: block;
      }

      .no-videos p {
        font-size: 16px;
        margin-bottom: 8px;
        color: #555;
      }

      .no-videos small {
        font-size: 14px;
        color: #888;
      }

      /* Estilos para o modal de visualiza√ß√£o de v√≠deo */
      .video-viewer .modal-content {
        max-width: 900px;
        width: 90%;
      }

      .video-container {
        margin-bottom: 20px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      }

      .video-container video {
        width: 100%;
        height: auto;
        display: block;
      }

      .video-details {
        padding: 20px 0;
      }

      .video-details h3 {
        color: var(--primary-color);
        margin-bottom: 10px;
        font-size: 1.4em;
      }

      .video-details p {
        color: #666;
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .video-meta {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }

      .video-meta span {
        background-color: #f0f0f0;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 12px;
        color: #666;
      }

      .video-actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

      .video-actions .btn {
        flex: 1;
        min-width: 80px;
      }

      @media (max-width: 768px) {
        .video-viewer .modal-content {
          width: 95%;
          margin: 10px;
        }
        
        .video-container video {
          height: 250px;
        }
        
        .video-meta {
          flex-direction: column;
          gap: 10px;
        }
        
        .video-actions {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <!-- Header Simplificado -->
    <header class="header-simple">
      <img src="/static/img/logo_if.png" alt="Instituto Franciscani" />
      <div class="logout-icon" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i>
      </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Perfil do Aluno -->
      <div class="student-profile">
        <div class="student-avatar">
          <img src="/static/img/logo_if_icon.png" alt="Carlos Silva" style="height: 70px; width: 70px;"/>
        </div>
                 <div class="student-details">
           <h2 class="nome-atleta">Carlos Silva</h2>
           <span class="student-category">Carregando...</span>
           <span class="student-sport modalidade-atleta">Nata√ß√£o</span>
           <p class="data-ingresso">Atleta desde 2020 | Foco: Provas de 100m e 200m livre</p>
         </div>
      </div>

      <!-- Dashboard Grid -->
      <div class="dashboard-grid">
        

        <!-- Feedback do Treinador -->
        <div class="card feedback" style="grid-column: span 4">
          <h3><i class="fas fa-comments"></i> Feedback do Treinador</h3>
          
          <!-- Feedback Content - Logo ap√≥s o t√≠tulo -->
          <div class="feedback-content" id="feedback-content">
            <div class="feedback-placeholder" style="display: none;">
              <div class="feedback-icon">
                <i class="fas fa-info-circle"></i>
              </div>
              <div class="feedback-text">
                <h4>Nenhum feedback espec√≠fico ainda</h4>
                <p>Seu treinador ainda n√£o deixou feedback personalizado. Continue treinando e ele aparecer√° aqui!</p>
              </div>
            </div>
            <div class="feedback-trainer" id="feedback-trainer" style="display: none;">
              <div class="trainer-avatar" id="trainer-avatar">RM</div>
              <div class="trainer-info">
                <h4 id="trainer-name">Seu Treinador</h4>
                <p id="trainer-feedback">Feedback ser√° atualizado aqui</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Assistir V√≠deos -->
        <div class="card videos" style="grid-column: span 4">
          <h3><i class="fas fa-video"></i> Meus V√≠deos</h3>
          <div class="videos-grid">
            <div class="video-item">
              <div class="video-thumbnail">
                <i class="fas fa-play"></i>
              </div>
              <div class="video-info">
                <h4>Treino 25/08 - 100m Livre</h4>
                <p>An√°lise t√©cnica</p>
              </div>
            </div>
            <div class="video-item">
              <div class="video-thumbnail">
                <i class="fas fa-play"></i>
              </div>
              <div class="video-info">
                <h4>Competi√ß√£o Estadual</h4>
                <p>Julho 2023 - 200m Livre</p>
              </div>
            </div>
            <div class="video-item">
              <div class="video-thumbnail">
                <i class="fas fa-play"></i>
              </div>
              <div class="video-info">
                <h4>Exerc√≠cios de Respira√ß√£o</h4>
                <p>Treinamento espec√≠fico</p>
              </div>
            </div>
            <div class="video-item">
              <div class="video-thumbnail">
                <i class="fas fa-play"></i>
              </div>
              <div class="video-info">
                <h4>Virada Ol√≠mpica</h4>
                <p>T√©cnica aprimorada</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Pr√≥ximas Competi√ß√µes -->
        <div class="card competitions" style="grid-column: span 4">
          <h3><i class="fas fa-trophy"></i> Pr√≥ximas Competi√ß√µes</h3>
          <div class="eventos-proximos">
            <!-- Ser√° preenchido dinamicamente -->
          </div>
        </div>

        <!-- Visualizar Dieta -->
        <div class="card diet" style="grid-column: span 3">
          <div class="diet-button" id="openDietModal">
            <i class="fas fa-utensils"></i>
            <h3>Visualizar Dieta</h3>
            <p>Clique para abrir o arquivo com seu plano alimentar</p>
          </div>
        </div>

        <!-- Desempenho Esperado x Atingido -->
        <div class="card performance" style="grid-column: span 9">
          <h3><i class="fas fa-chart-line"></i> Desempenho</h3>
          <div class="chart-container">
            <canvas id="performanceChart"></canvas>
          </div>
        </div>





        <!-- Pr√≥ximas Atividades no Calend√°rio Di√°rio -->
        <div class="card calendar" style="grid-column: span 6">
          <h3><i class="fas fa-calendar-day"></i> Calend√°rio de Treinos</h3>
          <div class="calendar">
            <div class="calendar-header">
              <h4 id="mes-calendario">--</h4>
              <div class="calendar-navigation">
                <button id="prev-month" class="nav-btn"><i class="fas fa-chevron-left"></i></button>
                <button id="next-month" class="nav-btn"><i class="fas fa-chevron-right"></i></button>
              </div>
            </div>
            <div class="calendar-grid" id="calendar-grid">
              <!-- Ser√° preenchido dinamicamente -->
              <div class="loading-calendar">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Carregando calend√°rio...</p>
              </div>
            </div>
          </div>
        </div>

        <!-- Atividades Realizadas no M√™s -->
        <div class="card activities" style="grid-column: span 6">
          <h3>
            <i class="fas fa-calendar-check"></i> Atividades Realizadas (<span id="mes-atual">--</span>)
          </h3>
          <div class="activities-list" id="atividades-container">
            <!-- Ser√° preenchido dinamicamente com dados do banco -->
            <div class="loading-activities">
              <i class="fas fa-spinner fa-spin"></i>
              <p>Carregando atividades...</p>
            </div>
          </div>
        </div>


    </main>

    <!-- Modal para Visualizar Dieta -->
    <div class="modal" id="dietModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Visualizar Dieta</h2>
          <button class="close-modal">&times;</button>
        </div>
        <p>Selecione o formato em que deseja visualizar sua dieta:</p>
        <div class="modal-actions">
          <button class="btn btn-outline">Visualizar Online</button>
          <button class="btn btn-primary">Baixar PDF</button>
        </div>
      </div>
    </div>

    <!-- Modal de Visualiza√ß√£o de V√≠deo -->
    <div id="videoViewModal" class="modal">
      <div class="modal-content video-viewer">
        <div class="modal-header">
          <h2 id="videoViewTitle">Visualizar V√≠deo</h2>
          <button class="close-modal" onclick="closeVideoViewModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div class="video-container">
            <video id="videoPlayer" controls width="100%" height="400">
              <source id="videoSource" src="" type="video/mp4">
              Seu navegador n√£o suporta o elemento de v√≠deo.
            </video>
          </div>
          <div class="video-details">
            <h3 id="videoViewDetailsTitle">T√≠tulo do V√≠deo</h3>
            <p id="videoViewDescription">Descri√ß√£o do v√≠deo...</p>
            <div class="video-meta">
              <span id="videoViewDate">Data de postagem</span>
              <span id="videoViewAthlete">Atleta relacionado</span>
            </div>
          </div>
        </div>
      </div>
    </div>


    <script>
      // Gr√°fico de desempenho
      let performanceChart = null;
      
      function criarGraficoDesempenho() {
        const ctx = document.getElementById("performanceChart").getContext("2d");
        
        // Destruir gr√°fico anterior se existir
        if (performanceChart) {
          performanceChart.destroy();
        }
        
        // Tentar carregar dados salvos do localStorage
        let dadosDesempenho = null;
        try {
          // Procurar por dados de desempenho salvos
          const chaves = Object.keys(localStorage);
          for (let chave of chaves) {
            if (chave.startsWith('desempenho_')) {
              const dados = JSON.parse(localStorage.getItem(chave));
              if (dados && dados.categorias && dados.desempenhoEsperado && dados.desempenhoAtingido) {
                dadosDesempenho = dados;
                break;
              }
            }
          }
        } catch (error) {
          console.error('‚ùå Erro ao carregar dados de desempenho:', error);
        }
        
        // Usar dados salvos ou dados zerados
        const labels = dadosDesempenho ? dadosDesempenho.categorias : [
          "100m Livre",
          "200m Livre", 
          "Resist√™ncia",
          "T√©cnica",
          "For√ßa",
        ];
        
        const esperado = dadosDesempenho ? dadosDesempenho.desempenhoEsperado : [0, 0, 0, 0, 0];
        const atingido = dadosDesempenho ? dadosDesempenho.desempenhoAtingido : [0, 0, 0, 0, 0];
        
        const titulo = dadosDesempenho ? "Desempenho" : "Desempenho (N√£o Avaliado)";
        
        performanceChart = new Chart(ctx, {
          type: "bar",
          data: {
            labels: labels,
            datasets: [
              {
                label: "Desempenho Esperado",
                data: esperado,
                backgroundColor: "rgba(0, 0, 94, 0.3)",
                borderColor: "#00005E",
                borderWidth: 1,
              },
              {
                label: "Desempenho Atingido",
                data: atingido,
                backgroundColor: "rgba(0, 180, 81, 0.5)",
                borderColor: "#00b451",
                borderWidth: 1,
              },
            ],
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            plugins: {
              title: {
                display: true,
                text: titulo,
                font: {
                  size: 16,
                  weight: 'bold'
                }
              }
            },
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                title: {
                  display: true,
                  text: "Pontua√ß√£o",
                },
              },
            },
          },
        });
      }
      
      // Configurar sincroniza√ß√£o
      function configurarSincronizacaoDesempenho() {
        // Escutar mudan√ßas no localStorage
        window.addEventListener('storage', function(e) {
          if (e.key && e.key.startsWith('desempenho_') && e.newValue) {
            console.log('üîÑ Dados de desempenho atualizados pelo professor!');
            
            try {
              const dados = JSON.parse(e.newValue);
              console.log('üìä Novos dados recebidos:', dados);
              
              // Recriar gr√°fico com novos dados
              criarGraficoDesempenho();
              
              // Mostrar notifica√ß√£o
              const notification = document.createElement('div');
              notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #00b451;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                z-index: 9999;
                font-family: 'Segoe UI', sans-serif;
                font-size: 14px;
                font-weight: 500;
              `;
              notification.innerHTML = '<i class="fas fa-sync-alt"></i> Desempenho atualizado pelo professor!';
              
              document.body.appendChild(notification);
              
              setTimeout(() => {
                notification.remove();
              }, 4000);
              
            } catch (error) {
              console.error('‚ùå Erro ao processar dados sincronizados:', error);
            }
          }
          
          // Escutar mudan√ßas no feedback
          if (e.key && e.key.startsWith('avaliacao_') && e.newValue) {
            console.log('üîÑ Feedback atualizado pelo professor!');
            
            try {
              const dados = JSON.parse(e.newValue);
              console.log('üìù Novo feedback recebido:', dados);
              
              // Recarregar feedback
              carregarFeedbackTreinador();
              
              // Mostrar notifica√ß√£o
              const notification = document.createElement('div');
              notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #2196f3;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                z-index: 9999;
                font-family: 'Segoe UI', sans-serif;
                font-size: 14px;
                font-weight: 500;
              `;
              notification.innerHTML = '<i class="fas fa-comments"></i> Novo feedback do treinador!';
              
              document.body.appendChild(notification);
              
              setTimeout(() => {
                notification.remove();
              }, 3000);
            } catch (error) {
              console.error('‚ùå Erro ao processar feedback:', error);
            }
          }
        });
      }
      
            // Inicializar gr√°fico e sincroniza√ß√£o
      criarGraficoDesempenho();
      configurarSincronizacaoDesempenho();

                   // Fun√ß√£o para carregar feedback do treinador
      async function carregarFeedbackTreinador() {
        try {
                  // Obter token de autentica√ß√£o
        const token = localStorage.getItem('jwt_token');
          if (!token) {
            console.log('‚ùå Token n√£o encontrado');
            mostrarPlaceholderFeedback();
            return;
          }
           
           // Buscar feedback do atleta logado
           // Primeiro, vamos tentar obter o ID do atleta do usu√°rio logado
           let atletaId = null;
           
           // Verificar se temos dados do usu√°rio no localStorage
           const usuarioInfo = localStorage.getItem('usuario_info');
           if (usuarioInfo) {
             try {
               const usuario = JSON.parse(usuarioInfo);
               console.log('üë§ Usu√°rio logado:', usuario);
               
               // Para Ana Mendon√ßa (usu√°rio ID 6), o atleta ID √© 1
               // Em um sistema real, isso seria buscado via API
               if (usuario.email === 'ana.mendonca@email.com') {
                 atletaId = 1;
               } else {
                 // Para outros usu√°rios, usar o ID do usu√°rio como fallback
                 atletaId = usuario.id;
               }
             } catch (error) {
               console.error('‚ùå Erro ao parsear dados do usu√°rio:', error);
               atletaId = 1; // Fallback para Ana Mendon√ßa
             }
           } else {
             console.log('‚ö†Ô∏è Dados do usu√°rio n√£o encontrados, usando ID padr√£o');
             atletaId = 1; // Fallback para Ana Mendon√ßa
           }
           
           console.log('üéØ ID do atleta a ser buscado:', atletaId);
           
           // Determinar URL base
           const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
           const apiURL = `${baseURL}/api/atletas/${atletaId}/feedback`;
           
                     const response = await fetch(apiURL, {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
          
          const resultado = await response.json();
           
           if (resultado.sucesso && resultado.feedback) {
             console.log('‚úÖ Feedback encontrado no banco:', resultado.feedback);
             mostrarFeedbackTreinador(resultado.feedback);
           } else {
             console.log('‚ö†Ô∏è Nenhum feedback encontrado no banco');
             mostrarPlaceholderFeedback();
           }
         } catch (error) {
           console.error('‚ùå Erro ao carregar feedback do banco:', error);
           mostrarPlaceholderFeedback();
         }
       }

            // Fun√ß√£o para mostrar feedback do treinador
      function mostrarFeedbackTreinador(feedbackData) {
        // Buscar elementos
        const placeholder = document.querySelector('.feedback-placeholder');
        const trainerSection = document.getElementById('feedback-trainer');
        const trainerName = document.getElementById('trainer-name');
        const trainerFeedback = document.getElementById('trainer-feedback');
        const trainerAvatar = document.getElementById('trainer-avatar');
        
        // Verificar se os elementos existem no DOM
        const feedbackContent = document.getElementById('feedback-content');
        
        // Se os elementos n√£o existem, criar dinamicamente
        if (!trainerSection || !trainerName || !trainerFeedback || !trainerAvatar) {
          if (feedbackContent) {
            // Limpar conte√∫do atual
            feedbackContent.innerHTML = '';
            
            // Criar se√ß√£o do treinador
            const trainerDiv = document.createElement('div');
            trainerDiv.className = 'feedback-trainer';
            trainerDiv.id = 'feedback-trainer';
            trainerDiv.style.display = 'flex';
            
            // Usar dados reais do feedback
            const iniciais = feedbackData.treinador_nome 
              ? feedbackData.treinador_nome.split(' ').map(n => n[0]).join('').toUpperCase()
              : 'T';
            
            trainerDiv.innerHTML = `
              <div class="trainer-avatar" id="trainer-avatar">${iniciais}</div>
              <div class="trainer-info">
                <h4 id="trainer-name">${feedbackData.treinador_nome || 'Treinador'}</h4>
                <p id="trainer-feedback">${feedbackData.feedback}</p>
              </div>
            `;
            
            // Adicionar ao DOM
            feedbackContent.appendChild(trainerDiv);
            return;
          }
        }
        
        // Se os elementos existem, atualizar normalmente
        if (placeholder) {
          placeholder.style.display = 'none';
        }
        
        if (trainerSection) {
          trainerSection.style.display = 'flex';
        }
        
        if (trainerName) {
          trainerName.textContent = feedbackData.treinador_nome || 'Treinador';
        }
        
        if (trainerFeedback) {
          trainerFeedback.textContent = feedbackData.feedback;
        }
        
        if (trainerAvatar) {
          const iniciais = feedbackData.treinador_nome 
            ? feedbackData.treinador_nome.split(' ').map(n => n[0]).join('').toUpperCase()
            : 'T';
          trainerAvatar.textContent = iniciais;
        }
      }

      // Fun√ß√£o para mostrar placeholder
      function mostrarPlaceholderFeedback() {
        const placeholder = document.querySelector('.feedback-placeholder');
        const trainerSection = document.getElementById('feedback-trainer');
        
        if (placeholder) placeholder.style.display = 'flex';
        if (trainerSection) trainerSection.style.display = 'none';
      }





      // Abrir modal de dieta
      document
        .getElementById("openDietModal")
        .addEventListener("click", function () {
          document.getElementById("dietModal").style.display = "flex";
        });

      // Fechar modal
      document
        .querySelector(".close-modal")
        .addEventListener("click", function () {
          document.getElementById("dietModal").style.display = "none";
        });

      // Fechar modal clicando fora
      window.addEventListener("click", function (event) {
        if (event.target == document.getElementById("dietModal")) {
          document.getElementById("dietModal").style.display = "none";
        }
      });

      // Fun√ß√£o de logout
      function logout() {
        if (confirm('Tem certeza que deseja sair?')) {
          window.location.href = '/';
        }
      }

      // Adicionar funcionalidade aos bot√µes do modal de dieta
      document.querySelector('.modal-actions .btn-outline').addEventListener('click', function() {
        alert('Visualizando dieta online...');
        document.getElementById('dietModal').style.display = 'none';
      });

      document.querySelector('.modal-actions .btn-primary').addEventListener('click', function() {
        alert('Download do PDF iniciado...');
        document.getElementById('dietModal').style.display = 'none';
      });

      // Remover event listeners antigos dos v√≠deos (agora s√£o gerenciados dinamicamente)
    </script>
    
    <!-- Scripts para dashboard personalizado -->
    <script src="static/js/frontend-config.js"></script>
    <script src="static/js/dashboard-aluno.js"></script>
    <script src="static/js/notificacoes.js"></script>
    
    <script>
      // =====================================================
      // SISTEMA DE SINCRONIZA√á√ÉO DE DESEMPENHO
      // =====================================================
      
      // Fun√ß√£o para carregar dados de desempenho do servidor
      async function carregarDesempenhoDoServidor() {
        try {
          const token = localStorage.getItem('jwt_token');
          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          
          // Determinar ID do atleta logado
          const usuarioInfo = JSON.parse(localStorage.getItem('usuario_info') || '{}');
          // Para Ana Mendon√ßa, usar ID 1 (que √© o ID do atleta na tabela atletas)
          const atletaId = 1; // Ana Mendon√ßa tem atleta_id = 1
          
          console.log('üìä [SINCRONIZA√á√ÉO] Carregando desempenho do servidor para atleta:', atletaId);
          
          const response = await fetch(`${baseURL}/api/atletas/${atletaId}/desempenho`, {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
          
          if (response.ok) {
            const data = await response.json();
            if (data.sucesso && data.desempenho) {
              console.log('‚úÖ [SINCRONIZA√á√ÉO] Desempenho carregado do servidor:', data.desempenho);
              
              // Verificar se houve mudan√ßas comparando com localStorage
              const dadosAnteriores = localStorage.getItem(`desempenho_${atletaId}`);
              let houveMudanca = true;
              
              if (dadosAnteriores) {
                try {
                  const dadosAnt = JSON.parse(dadosAnteriores);
                  const ultimaAtualizacaoAnterior = dadosAnt.ultima_atualizacao;
                  const ultimaAtualizacaoAtual = data.desempenho.ultima_atualizacao;
                  
                  if (ultimaAtualizacaoAnterior === ultimaAtualizacaoAtual) {
                    houveMudanca = false;
                    console.log('üìä [SINCRONIZA√á√ÉO] Nenhuma mudan√ßa detectada');
                  } else {
                    console.log('üîÑ [SINCRONIZA√á√ÉO] Mudan√ßa detectada!');
                    console.log('üìä [SINCRONIZA√á√ÉO] Anterior:', ultimaAtualizacaoAnterior);
                    console.log('üìä [SINCRONIZA√á√ÉO] Atual:', ultimaAtualizacaoAtual);
                  }
                } catch (error) {
                  console.log('‚ö†Ô∏è [SINCRONIZA√á√ÉO] Erro ao comparar dados anteriores:', error);
                }
              }
              
              // Atualizar gr√°fico apenas se houve mudan√ßa
              if (houveMudanca) {
                console.log('üîÑ [SINCRONIZA√á√ÉO] Atualizando gr√°fico com novos dados...');
                
                // Atualizar gr√°fico de desempenho se existir
                if (window.atualizarGraficoDesempenho) {
                  window.atualizarGraficoDesempenho(data.desempenho.categorias);
                }
                
                // Mostrar notifica√ß√£o de atualiza√ß√£o
                const notification = document.createElement('div');
                notification.style.cssText = `
                  position: fixed;
                  top: 20px;
                  right: 20px;
                  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                  color: white;
                  padding: 15px 20px;
                  border-radius: 8px;
                  box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
                  z-index: 9999;
                  font-weight: 500;
                `;
                notification.innerHTML = '<i class="fas fa-sync-alt"></i> Desempenho atualizado pelo professor!';
                
                document.body.appendChild(notification);
                
                setTimeout(() => {
                  notification.remove();
                }, 3000);
              }
              
              // Salvar no localStorage para cache
              localStorage.setItem(`desempenho_${atletaId}`, JSON.stringify(data.desempenho));
              
              return data.desempenho;
            }
          } else {
            console.error('‚ùå [SINCRONIZA√á√ÉO] Erro ao carregar desempenho:', response.status);
          }
        } catch (error) {
          console.error('‚ùå [SINCRONIZA√á√ÉO] Erro na requisi√ß√£o:', error);
        }
        return null;
      }
      
      // Fun√ß√£o para atualizar gr√°fico de desempenho
      function atualizarGraficoDesempenho(categorias) {
        console.log('üìä [SINCRONIZA√á√ÉO] Atualizando gr√°fico com dados:', categorias);
        
        // Verificar se o gr√°fico existe
        const canvas = document.getElementById('performanceChart');
        if (!canvas) {
          console.log('‚ö†Ô∏è [SINCRONIZA√á√ÉO] Canvas do gr√°fico n√£o encontrado');
          return;
        }
        
        // Verificar se Chart.js est√° dispon√≠vel
        if (typeof Chart === 'undefined') {
          console.log('‚ö†Ô∏è [SINCRONIZA√á√ÉO] Chart.js n√£o est√° dispon√≠vel');
          return;
        }
        
        // Destruir gr√°fico existente se houver
        if (window.performanceChart) {
          try {
            window.performanceChart.destroy();
          } catch (e) {
            console.log('‚ö†Ô∏è [SINCRONIZA√á√ÉO] Erro ao destruir gr√°fico anterior:', e);
          }
          window.performanceChart = null;
        }
        
        // Limpar canvas completamente e remover do Chart.js registry
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // Remover canvas do Chart.js registry se existir
        if (typeof Chart !== 'undefined' && Chart.getChart) {
          const existingChart = Chart.getChart(canvas);
          if (existingChart) {
            try {
              existingChart.destroy();
            } catch (e) {
              console.log('‚ö†Ô∏è [SINCRONIZA√á√ÉO] Erro ao destruir chart do registry:', e);
            }
          }
        }
        
        // For√ßar limpeza do canvas
        canvas.width = canvas.width;
        
        // Preparar dados para o Chart.js
        const labels = Object.keys(categorias).map(key => {
          switch(key) {
            case '100m_livre': return '100m Livre';
            case '200m_livre': return '200m Livre';
            case 'resistencia': return 'Resist√™ncia';
            case 'tecnica': return 'T√©cnica';
            case 'forca': return 'For√ßa';
            default: return key;
          }
        });
        
        const esperadoData = Object.values(categorias).map(cat => cat.esperado);
        const atingidoData = Object.values(categorias).map(cat => cat.atingido);
        
        console.log('üìä [SINCRONIZA√á√ÉO] Dados preparados:', {
          labels: labels,
          esperado: esperadoData,
          atingido: atingidoData
        });
        
        // Criar novo gr√°fico
        window.performanceChart = new Chart(ctx, {
          type: 'bar',
          data: {
            labels: labels,
            datasets: [
              {
                label: 'Desempenho Esperado',
                data: esperadoData,
                backgroundColor: 'rgba(102, 126, 234, 0.8)',
                borderColor: 'rgba(102, 126, 234, 1)',
                borderWidth: 1
              },
              {
                label: 'Desempenho Atingido',
                data: atingidoData,
                backgroundColor: 'rgba(46, 204, 113, 0.8)',
                borderColor: 'rgba(46, 204, 113, 1)',
                borderWidth: 1
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: {
                beginAtZero: true,
                max: 100,
                ticks: {
                  stepSize: 10
                }
              }
            },
            plugins: {
              legend: {
                position: 'top',
              },
              title: {
                display: true,
                text: 'Desempenho - Nata√ß√£o'
              }
            }
          }
        });
        
        console.log('‚úÖ [SINCRONIZA√á√ÉO] Gr√°fico atualizado com sucesso');
      }
      
      // Escutar eventos de atualiza√ß√£o de desempenho
      window.addEventListener('desempenhoAtualizado', (event) => {
        console.log('üîÑ [SINCRONIZA√á√ÉO] Evento de atualiza√ß√£o recebido:', event.detail);
        
        const { atletaId, dados } = event.detail;
        const usuarioInfo = JSON.parse(localStorage.getItem('usuario_info') || '{}');
        const meuAtletaId = 1; // Ana Mendon√ßa tem atleta_id = 1
        
        // Verificar se a atualiza√ß√£o √© para o atleta logado
        if (atletaId == meuAtletaId) {
          console.log('‚úÖ [SINCRONIZA√á√ÉO] Atualiza√ß√£o √© para este atleta, aplicando mudan√ßas...');
          
          // Atualizar gr√°fico
          if (dados.categorias) {
            atualizarGraficoDesempenho(dados.categorias);
          }
          
          // Mostrar notifica√ß√£o
          const notification = document.createElement('div');
          notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            border-radius: 8px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            font-weight: 500;
          `;
          notification.innerHTML = '<i class="fas fa-sync-alt"></i> Desempenho atualizado pelo professor!';
          
          document.body.appendChild(notification);
          
          setTimeout(() => {
            notification.remove();
          }, 3000);
        }
      });
      
      // Escutar mudan√ßas no localStorage (para sincroniza√ß√£o entre abas)
      window.addEventListener('storage', (event) => {
        if (event.key && event.key.startsWith('desempenho_')) {
          console.log('üîÑ [SINCRONIZA√á√ÉO] Mudan√ßa no localStorage detectada:', event.key);
          
          try {
            const dados = JSON.parse(event.newValue);
            if (dados && dados.categorias) {
              atualizarGraficoDesempenho(dados.categorias);
            }
          } catch (error) {
            console.error('‚ùå [SINCRONIZA√á√ÉO] Erro ao processar dados do localStorage:', error);
          }
        }
      });
      
      // Sistema de polling para verificar atualiza√ß√µes
      let pollingInterval = null;
      
      function iniciarPolling() {
        // Verificar atualiza√ß√µes a cada 5 segundos para sincroniza√ß√£o mais r√°pida
        pollingInterval = setInterval(() => {
          carregarDesempenhoDoServidor();
        }, 5000);
        
        console.log('üîÑ [SINCRONIZA√á√ÉO] Polling iniciado (5s)');
      }
      
      function pararPolling() {
        if (pollingInterval) {
          clearInterval(pollingInterval);
          pollingInterval = null;
          console.log('‚èπÔ∏è [SINCRONIZA√á√ÉO] Polling parado');
        }
      }
      
             // Carregar dados iniciais quando a p√°gina carregar
       document.addEventListener('DOMContentLoaded', () => {
         console.log('üöÄ [SINCRONIZA√á√ÉO] Inicializando sistema de sincroniza√ß√£o...');
         carregarDesempenhoDoServidor();
         iniciarPolling();
       });
      
      // Parar polling quando a p√°gina for fechada
      window.addEventListener('beforeunload', () => {
        pararPolling();
      });
      
      // =====================================================
      // SISTEMA DE V√çDEOS DO ATLETA
      // =====================================================
      
      // Fun√ß√£o para carregar v√≠deos do atleta
      async function carregarVideosDoAtleta() {
        try {
          const token = localStorage.getItem('jwt_token');
          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          
          // Determinar ID do atleta logado
          const usuarioInfo = JSON.parse(localStorage.getItem('usuario_info') || '{}');
          const atletaId = 1; // Ana Mendon√ßa tem atleta_id = 1
          
          console.log('üé• [V√çDEOS] Carregando v√≠deos para atleta:', atletaId);
          
          const response = await fetch(`${baseURL}/api/atletas/${atletaId}/videos`, {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
          
          if (!response.ok) {
            throw new Error(`HTTP ${response.status}: ${response.statusText}`);
          }
          
          const data = await response.json();
          console.log('üé• [V√çDEOS] Resposta da API:', data);
          
          if (data.sucesso) {
            atualizarListaVideos(data.videos);
          } else {
            console.error('‚ùå [V√çDEOS] Erro na API:', data.erro);
          }
          
        } catch (error) {
          console.error('‚ùå [V√çDEOS] Erro ao carregar v√≠deos:', error);
        }
      }
      
      // Fun√ß√£o para atualizar a lista de v√≠deos na interface
      function atualizarListaVideos(videos) {
        const videosGrid = document.querySelector('.videos-grid');
        if (!videosGrid) {
          console.error('‚ùå [V√çDEOS] Container de v√≠deos n√£o encontrado');
          return;
        }
        
        // Limpar v√≠deos existentes
        videosGrid.innerHTML = '';
        
        if (videos.length === 0) {
          // Mostrar mensagem quando n√£o h√° v√≠deos
          videosGrid.innerHTML = `
            <div class="no-videos">
              <i class="fas fa-video-slash"></i>
              <p>Nenhum v√≠deo dispon√≠vel</p>
              <small>Seus v√≠deos de treino aparecer√£o aqui quando forem enviados</small>
            </div>
          `;
          return;
        }
        
        // Adicionar cada v√≠deo
        videos.forEach(video => {
          const videoElement = criarElementoVideo(video);
          videosGrid.appendChild(videoElement);
        });
        
        console.log(`‚úÖ [V√çDEOS] ${videos.length} v√≠deos carregados na interface`);
      }
      
      // Fun√ß√£o para criar elemento de v√≠deo
      function criarElementoVideo(video) {
        const videoDiv = document.createElement('div');
        videoDiv.className = 'video-item';
        videoDiv.onclick = () => visualizarVideo(video);
        
        // Calcular tempo relativo e data completa
        const dataUpload = new Date(video.data_upload);
        const tempoRelativo = calcularTempoRelativo(dataUpload);
        const dataHoraCompleta = formatarDataHoraCompleta(dataUpload);
        
        videoDiv.innerHTML = `
          <div class="video-thumbnail">
            <i class="fas fa-play"></i>
          </div>
          <div class="video-info">
            <h4>${video.titulo}</h4>
            <p>${video.descricao || 'V√≠deo de treinamento'}</p>
            <small>Postado por ${video.treinador_nome} ‚Ä¢ ${tempoRelativo}</small>
            <small class="video-datetime">${dataHoraCompleta}</small>
          </div>
        `;
        
        return videoDiv;
      }
      
      // Fun√ß√£o para calcular tempo relativo
      function calcularTempoRelativo(data) {
        const agora = new Date();
        const dataUpload = new Date(data);
        
        // Converter para hor√°rio de Bras√≠lia (UTC-3)
        const offsetBrasilia = -3 * 60; // -3 horas em minutos
        const agoraBrasilia = new Date(agora.getTime() + (offsetBrasilia * 60000));
        const dataUploadBrasilia = new Date(dataUpload.getTime() + (offsetBrasilia * 60000));
        
        // Normalizar para o in√≠cio do dia (00:00:00) em Bras√≠lia
        const hojeBrasilia = new Date(agoraBrasilia.getFullYear(), agoraBrasilia.getMonth(), agoraBrasilia.getDate());
        const dataUploadNormalizada = new Date(dataUploadBrasilia.getFullYear(), dataUploadBrasilia.getMonth(), dataUploadBrasilia.getDate());
        
        const diffMs = hojeBrasilia - dataUploadNormalizada;
        const diffDias = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        
        // Debug para verificar os valores
        console.log('üïê [DEBUG] Tempo relativo (Bras√≠lia):', {
          agora: agora.toISOString(),
          dataUpload: dataUpload.toISOString(),
          agoraBrasilia: agoraBrasilia.toISOString(),
          dataUploadBrasilia: dataUploadBrasilia.toISOString(),
          hojeBrasilia: hojeBrasilia.toISOString(),
          dataUploadNormalizada: dataUploadNormalizada.toISOString(),
          diffMs: diffMs,
          diffDias: diffDias
        });
        
        if (diffDias === 0) {
          return 'Hoje';
        } else if (diffDias === 1) {
          return 'Ontem';
        } else if (diffDias < 7) {
          return `${diffDias} dias atr√°s`;
        } else if (diffDias < 30) {
          const semanas = Math.floor(diffDias / 7);
          return `${semanas} semana${semanas > 1 ? 's' : ''} atr√°s`;
        } else {
          const meses = Math.floor(diffDias / 30);
          return `${meses} m√™s${meses > 1 ? 'es' : ''} atr√°s`;
        }
      }

      // Fun√ß√£o para formatar data e hora completa
      function formatarDataHoraCompleta(data) {
        const dataObj = new Date(data);
        
        // Converter para hor√°rio de Bras√≠lia (UTC-3)
        const offsetBrasilia = -3 * 60; // -3 horas em minutos
        const dataBrasilia = new Date(dataObj.getTime() + (offsetBrasilia * 60000));
        
        const opcoes = {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          hour12: false,
          timeZone: 'America/Sao_Paulo'
        };
        return dataBrasilia.toLocaleString('pt-BR', opcoes);
      }
      
      // Fun√ß√£o para visualizar v√≠deo
      function visualizarVideo(video) {
        console.log('üé• [V√çDEO] Iniciando visualiza√ß√£o:', video);
        
        // Preencher o modal de visualiza√ß√£o
        const videoElement = document.getElementById('videoPlayer');
        const videoSource = document.getElementById('videoSource');
        const videoTitle = document.getElementById('videoViewDetailsTitle');
        const videoDescription = document.getElementById('videoViewDescription');
        const videoDate = document.getElementById('videoViewDate');
        const videoAthlete = document.getElementById('videoViewAthlete');
        
        if (!videoElement || !videoSource) {
          console.error('‚ùå [V√çDEO] Elementos do player n√£o encontrados');
          alert('Erro: Player de v√≠deo n√£o encontrado');
          return;
        }
        
        // Verificar se a URL do v√≠deo √© v√°lida
        if (!video.url_video || video.url_video.trim() === '') {
          console.error('‚ùå [V√çDEO] URL do v√≠deo inv√°lida:', video.url_video);
          alert('Erro: URL do v√≠deo n√£o dispon√≠vel');
          return;
        }
        
        console.log('üé• [V√çDEO] Configurando v√≠deo com URL:', video.url_video);
        
        // Construir URL correta para arquivos locais
        let videoUrl = video.url_video;
        if (video.url_video.startsWith('/uploads/')) {
          // Para arquivos locais, usar a rota do Flask
          videoUrl = `http://localhost:5000${video.url_video}`;
        }
        
        console.log('üé• [V√çDEO] URL final do v√≠deo:', videoUrl);
        
        // Configurar o v√≠deo
        videoSource.src = videoUrl;
        videoElement.load(); // Recarregar o v√≠deo com a nova fonte
        
        // Adicionar event listeners para debug
        videoElement.addEventListener('loadstart', () => {
          console.log('üé• [V√çDEO] Iniciando carregamento...');
        });
        
        videoElement.addEventListener('canplay', () => {
          console.log('‚úÖ [V√çDEO] V√≠deo pode ser reproduzido');
        });
        
        videoElement.addEventListener('error', (e) => {
          console.error('‚ùå [V√çDEO] Erro ao carregar v√≠deo:', e);
          console.error('‚ùå [V√çDEO] Erro details:', videoElement.error);
          alert('Erro ao carregar v√≠deo. Verifique a URL ou tente novamente.');
        });
        
        videoElement.addEventListener('loadeddata', () => {
          console.log('‚úÖ [V√çDEO] Dados do v√≠deo carregados');
        });
        
        // Calcular tempo relativo e data completa
        const dataUpload = new Date(video.data_upload);
        const tempoRelativo = calcularTempoRelativo(dataUpload);
        const dataHoraCompleta = formatarDataHoraCompleta(dataUpload);
        
        // Preencher informa√ß√µes
        videoTitle.textContent = video.titulo;
        videoDescription.textContent = video.descricao || 'Sem descri√ß√£o dispon√≠vel';
        videoDate.textContent = `${tempoRelativo} (${dataHoraCompleta})`;
        videoAthlete.textContent = `Postado por ${video.treinador_nome}`;
        
        console.log('üé• [V√çDEO] Abrindo modal...');
        
        // Abrir o modal
        document.getElementById('videoViewModal').style.display = 'block';
      }

      // Fun√ß√£o para fechar o modal de visualiza√ß√£o de v√≠deo
      function closeVideoViewModal() {
        document.getElementById('videoViewModal').style.display = 'none';
        // Pausar o v√≠deo quando fechar o modal
        const videoPlayer = document.getElementById('videoPlayer');
        videoPlayer.pause();
        videoPlayer.currentTime = 0;
      }

      // Event listener para fechar modal ao clicar fora dele
      window.addEventListener('click', function(event) {
        const videoModal = document.getElementById('videoViewModal');
        if (event.target === videoModal) {
          closeVideoViewModal();
        }
      });
      
                   // Carregar dados quando a p√°gina carregar
      document.addEventListener('DOMContentLoaded', () => {
        // Carregar feedback do treinador automaticamente
        carregarFeedbackTreinador();
        
        // Carregar v√≠deos do atleta
        carregarVideosDoAtleta();
      });
      
      // Fallback: se o DOM j√° estiver carregado, executar imediatamente
      if (document.readyState === 'loading') {
        // DOM ainda carregando, aguardar DOMContentLoaded
      } else {
        // DOM j√° carregado, executar imediatamente
        console.log('üöÄ DOM j√° carregado, carregando feedback automaticamente...');
        carregarFeedbackTreinador();
        carregarVideosDoAtleta();
      }

      // Sistema de calend√°rio integrado com dashboard-aluno.js
      
      // Expor fun√ß√£o globalmente para uso por outros scripts
      window.atualizarGraficoDesempenho = atualizarGraficoDesempenho;
      window.carregarVideosDoAtleta = carregarVideosDoAtleta;
      
      // Fun√ß√£o de teste para feedback
      window.testarFeedback = function() {
        console.log('üß™ [TESTE] Testando sistema de feedback...');
        console.log('üîë Token atual:', localStorage.getItem('jwt_token'));
        carregarFeedbackTreinador();
      };
      
      // Fun√ß√£o para definir token de teste
      window.definirTokenTeste = function() {
        const tokenTeste = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c3VhcmlvX2lkIjo2LCJ0aXBvX3VzdWFyaW8iOiJhbHVubyIsImV4cCI6MTc1Njk1Njg1Mn0.ZxFI3E4-3CX1K7oZ0j5xVL2eH8gQtSCCBkYq9nGOnO';
        localStorage.setItem('jwt_token', tokenTeste);
        console.log('‚úÖ Token de teste definido');
        carregarFeedbackTreinador();
      };
      

    </script>
  </body>
</html>
