<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dashboard | Instituto Franciscani</title>
    <link rel="shortcut icon" href="/static/img/logo_if_icon.png" type="" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }

      :root {
        --primary-color: #00005e;
        --secondary-color: #010146;
        --accent-color: #08083a;
        --light-color: #f8f9fa;
        --dark-color: #212529;
        --success-color: #00b451;
        --warning-color: #f72548;
        --gray-color: #adb5bd;
        --sidebar-width: 250px;
        --header-height: 70px;
        --transition: all 0.3s ease;
        --info-color: #4895ef;
      }

      body {
        background-color: #f5f7fb;
        color: var(--dark-color);
        display: flex;
        min-height: 100vh;
      }

      /* Sidebar */
      .sidebar {
        width: var(--sidebar-width);
        background: linear-gradient(
          to bottom,
          var(--primary-color),
          var(--secondary-color)
        );
        color: white;
        height: 100vh;
        position: fixed;
        display: flex;
        flex-direction: column;
        justify-content: space-between;
        padding: 20px 0;
        box-shadow: 0 0 15px rgba(0, 0, 0, 0.1);
        z-index: 1000;
      }

      .sidebar-header {
        padding: 0 20px 20px;
        border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        margin-bottom: 20px;
      }

      .sidebar-header h2 {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .sidebar-header h2 i {
        background: white;
        color: var(--primary-color);
        width: 35px;
        height: 35px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .menu-items {
        list-style: none;
        padding: 0 15px;
      }

      .menu-items li {
        margin-bottom: 5px;
      }

      .menu-items a {
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 15px;
        border-radius: 8px;
        transition: var(--transition);
      }

      .menu-items a:hover,
      .menu-items a.active {
        background-color: rgba(255, 255, 255, 0.1);
      }

      .menu-items a i {
        width: 20px;
        text-align: center;
      }

      .sidebar-footer {
        padding: 20px;
        border-top: 1px solid rgba(255, 255, 255, 0.2);
      }

      .sidebar-footer a {
        color: white;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 10px 15px;
        border-radius: 8px;
        transition: var(--transition);
      }

      .sidebar-footer a:hover {
        background-color: rgba(255, 255, 255, 0.1);
      }

      /* Main Content */
      .main-content {
        flex: 1;
        margin-left: var(--sidebar-width);
        padding: 20px;
      }

      /* Header */
      .header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background-color: white;
        padding: 15px 25px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        margin-bottom: 25px;
      }

      .user-info {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .user-avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: linear-gradient(
          to right,
          var(--accent-color),
          var(--primary-color)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
        font-size: 18px;
      }

      .user-details h4 {
        margin-bottom: 3px;
      }

      .user-details p {
        color: var(--gray-color);
        font-size: 14px;
      }

      .search-bar {
        flex: 1;
        max-width: 400px;
        margin: 0 20px;
        position: relative;
      }

      .search-bar input {
        width: 100%;
        padding: 12px 20px 12px 45px;
        border: none;
        background-color: #f5f7fb;
        border-radius: 25px;
        font-size: 14px;
      }

      .search-bar i {
        position: absolute;
        left: 15px;
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-color);
      }

      .header-actions {
        display: flex;
        align-items: center;
        gap: 20px;
      }

      .action-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #f5f7fb;
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--dark-color);
        cursor: pointer;
        transition: var(--transition);
      }

      .action-icon:hover {
        background-color: var(--primary-color);
        color: white;
      }

      /* Dashboard Grid */
      .dashboard-grid {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 25px;
        margin-bottom: 25px;
      }

      .card {
        background-color: white;
        border-radius: 12px;
        padding: 20px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
      }

      .stat-card {
        display: flex;
        flex-direction: column;
      }

      .stat-card h3 {
        color: var(--gray-color);
        font-size: 14px;
        font-weight: 600;
        margin-bottom: 10px;
      }

      .stat-card .number {
        font-size: 50px;
        font-weight: bolder;
        color: var(--primary-color);
        margin: 10px 0;
        transition: color 0.3s ease;
      }
      
      /* Cores específicas para estatísticas de treinos */
      #treinosConcluidosCard .number.percentual-verde {
        color: var(--success-color) !important;
      }
      
      #treinosConcluidosCard .number.percentual-amarelo {
        color: var(--warning-color) !important;
      }
      
      #treinosConcluidosCard .number.percentual-vermelho {
        color: #f72548 !important;
      }
      
      #treinosConcluidosCard .trend.trend-verde {
        color: var(--success-color) !important;
      }
      
      #treinosConcluidosCard .trend.trend-amarelo {
        color: var(--warning-color) !important;
      }
      
      #treinosConcluidosCard .trend.trend-vermelho {
        color: #f72548 !important;
      }
      
      /* Garantir que não haja sobreposição */
      #treinosConcluidosCard .number {
        position: relative;
        z-index: 1;
      }
      
      #treinosConcluidosCard .trend {
        position: relative;
        z-index: 1;
      }
      
      /* Limpar qualquer conteúdo duplicado */
      #treinosConcluidosCard .number::before,
      #treinosConcluidosCard .number::after {
        content: none !important;
      }
      
      #treinosConcluidosCard .trend::before,
      #treinosConcluidosCard .trend::after {
        content: none !important;
      }
      
      /* Forçar cores específicas para estatísticas */
      #treinosConcluidosCard .number {
        color: #00005e !important;
      }
      
      #treinosConcluidosCard .trend {
        color: #00005e !important;
      }

      .stat-card .trend {
        display: flex;
        align-items: center;
        gap: 5px;
        color: var(--success-color);
        font-size: 14px;
      }

      /* BOTÃO DE DIETAS MAIS FINO */
      .diet-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        background: linear-gradient(
          to right,
          var(--primary-color),
          var(--accent-color)
        );
        color: white;
        cursor: pointer;
        transition: var(--transition);
        padding: 15px; /* Reduzido para parecer mais fino */
        border: 2px solid rgba(255, 255, 255, 0.2); /* Adiciona borda para manter a sensação de botão */
      }

      .diet-card:hover {
        transform: translateY(-3px); /* Efeito mais sutil */
        box-shadow: 0 5px 15px rgba(0, 0, 94, 0.3);
        border-color: rgba(255, 255, 255, 0.4);
      }

      .diet-card i {
        font-size: 32px; /* Reduzido para combinar com o design mais fino */
        margin-bottom: 10px;
      }

      .diet-card h3 {
        font-size: 18px; /* Reduzido para combinar com o design mais fino */
        margin-bottom: 5px;
        font-weight: 600;
      }

      .diet-card p {
        text-align: center;
        font-size: 13px; /* Reduzido para combinar com o design mais fino */
        opacity: 0.9;
        margin: 0;
      }

      .version-card {
        display: flex;
        flex-direction: column;
        background: linear-gradient(to right, var(--primary-color), #110135);
        color: white;
        position: relative;
        overflow: hidden;
      }

      .version-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 15px;
      }

      .version-header h3 {
        font-size: 18px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .version-badge {
        background-color: rgba(255, 255, 255, 0.2);
        padding: 4px 10px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
      }

      .version-list {
        flex: 1;
        overflow-y: auto;
        max-height: 150px;
      }

      .version-item {
        padding: 8px 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      }

      .version-item:last-child {
        border-bottom: none;
      }

      .version-item p {
        font-size: 13px;
        display: flex;
        align-items: flex-start;
        gap: 8px;
      }

      .version-item i {
        color: #ffffff;
        font-size: 12px;
        margin-top: 4px;
      }

      /* Chart and Athletes Section */
      .chart-athletes {
        display: grid;
        grid-template-columns: 2fr 1fr;
        gap: 25px;
        margin-bottom: 25px;
      }

      .chart-container {
        height: 300px;
      }

      .athletes-scroll {
        max-height: 300px;
        overflow-y: auto;
      }

      .athletes-scroll h3 {
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .athlete-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .athlete-avatar {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background: linear-gradient(
          to right,
          var(--accent-color),
          var(--primary-color)
        );
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-weight: bold;
      }

      .athlete-details h4 {
        margin-bottom: 3px;
        font-size: 15px;
      }

      .athlete-details p {
        color: var(--gray-color);
        font-size: 13px;
      }

      /* Competitions */
      .competitions-card {
        grid-column: span 3;
      }

      .competitions-card h3 {
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 1px solid #eee;
      }

      .competition-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 12px 0;
        border-bottom: 1px solid #f0f0f0;
      }

      .competition-date {
        background-color: #f5f7fb;
        padding: 10px;
        border-radius: 8px;
        text-align: center;
        min-width: 60px;
      }

      .competition-date .day {
        font-size: 20px;
        font-weight: 700;
        color: var(--primary-color);
      }

      .competition-date .month {
        font-size: 12px;
        color: var(--gray-color);
      }

      .competition-details h4 {
        margin-bottom: 5px;
        font-size: 16px;
      }

      .competition-details p {
        color: var(--gray-color);
        font-size: 13px;
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        align-items: center;
        justify-content: center;
      }

      .modal-content {
        background-color: white;
        width: 500px;
        max-width: 90%;
        border-radius: 12px;
        padding: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
      }

      .modal-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .modal-header h2 {
        color: var(--primary-color);
      }

      .close-modal {
        background: none;
        border: none;
        font-size: 24px;
        cursor: pointer;
        color: var(--gray-color);
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--dark-color);
      }

      .form-group select,
      .form-group input[type="file"] {
        width: 100%;
        padding: 12px 15px;
        border: 1px solid #ddd;
        border-radius: 8px;
        font-size: 15px;
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 15px;
        margin-top: 20px;
      }

      .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: var(--transition);
      }

      .btn-primary {
        background-color: var(--primary-color);
        color: white;
      }

      .btn-primary:hover {
        background-color: var(--secondary-color);
      }

      .btn-outline {
        background-color: transparent;
        border: 1px solid #ddd;
      }

      .btn-outline:hover {
        background-color: #f5f7fb;
      }

      /* Responsividade */
      @media (max-width: 1200px) {
        .dashboard-grid {
          grid-template-columns: 1fr 1fr;
        }

        .diet-card {
          grid-column: span 2;
        }

        .version-card {
          grid-column: span 2;
        }

        .competitions-card {
          grid-column: span 2;
        }
      }

      @media (max-width: 992px) {
        .sidebar {
          width: 70px;
          overflow: hidden;
        }

        .sidebar-header h2 span,
        .menu-items a span,
        .sidebar-footer a span {
          display: none;
        }

        .main-content {
          margin-left: 70px;
        }

        .chart-athletes {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .dashboard-grid {
          grid-template-columns: 1fr;
        }

        .diet-card {
          grid-column: span 1;
        }

        .version-card {
          grid-column: span 1;
        }

        .competitions-card {
          grid-column: span 1;
        }

        .header {
          flex-direction: column;
          gap: 15px;
          padding: 15px;
        }

        .search-bar {
          max-width: 100%;
          margin: 0;
        }

        .user-info {
          width: 100%;
          justify-content: center;
        }

        .header-actions {
          width: 100%;
          justify-content: center;
        }
      }

      /* Estilo para botões de ação */
      .action-icon {
        cursor: pointer;
      }

      .action-icon:hover {
        background-color: var(--primary-color);
        color: white;
      }

      /* Estilos para modal de notificações */
      .notifications-list {
        max-height: 300px;
        overflow-y: auto;
      }

      .notification-item {
        padding: 12px;
        border-bottom: 1px solid #eee;
        cursor: pointer;
        transition: background-color 0.2s;
      }

      .notification-item:hover {
        background-color: #f8f9fa;
      }

      .notification-item.unread {
        background-color: #e3f2fd;
        border-left: 3px solid var(--primary-color);
      }
      
      /* Estilos para diferentes tipos de notificações */
      .notification-item.sucesso {
        border-left-color: #28a745;
        background-color: #d4edda;
      }
      
      .notification-item.sucesso .notification-content p {
        color: #155724;
      }
      
      .notification-item.info {
        border-left-color: #17a2b8;
        background-color: #d1ecf1;
      }
      
      .notification-item.info .notification-content p {
        color: #0c5460;
      }
      
      .notification-item.aviso {
        border-left-color: #ffc107;
        background-color: #fff3cd;
      }
      
      .notification-item.aviso .notification-content p {
        color: #856404;
      }
      
      /* Estilos para notificações toast */
      .toast-notification {
        position: fixed;
        top: 20px;
        right: 20px;
        background: #333;
        color: white;
        padding: 15px 20px;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        z-index: 10000;
        animation: slideInRight 0.3s ease-out;
        max-width: 400px;
      }
      
      .toast-content {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 15px;
        font-size: 14px;
      }
      
      .toast-content button {
        background: none;
        border: none;
        color: white;
        font-size: 18px;
        cursor: pointer;
        padding: 0;
        width: 20px;
        height: 20px;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      
      .toast-content button:hover {
        background: rgba(255,255,255,0.2);
        border-radius: 50%;
      }
      
      @keyframes slideInRight {
        from {
          transform: translateX(100%);
          opacity: 0;
        }
        to {
          transform: translateX(0);
          opacity: 1;
        }
      }
      
      /* Estilos para categorias de notificações */
      .notification-item[data-categoria="cadastro"] {
        border-left-color: #6f42c1;
        background-color: #e2d9f3;
      }
      
      .notification-item[data-categoria="treino"] {
        border-left-color: #fd7e14;
        background-color: #ffe8d1;
      }
      
      .notification-item[data-categoria="calendario"] {
        border-left-color: #20c997;
        background-color: #d1f2eb;
      }

      .notification-content {
        display: flex;
        align-items: flex-start;
        gap: 10px;
      }

      .unread-dot {
        width: 8px;
        height: 8px;
        background-color: var(--primary-color);
        border-radius: 50%;
        margin-top: 6px;
        flex-shrink: 0;
      }

      /* Estilos para modal de configurações */
      .settings-content {
        padding: 20px;
      }

      .settings-content .form-group {
        margin-bottom: 20px;
      }

      .settings-content .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #333;
      }

      .settings-content .form-group input,
      .settings-content .form-group select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 14px;
      }

      .settings-content .form-group input[type="checkbox"] {
        width: auto;
        margin-right: 8px;
      }

      .settings-content .form-group .checkbox-label {
        display: flex;
        align-items: center;
        cursor: pointer;
      }

      /* Estilos para modal de vídeos */
      .video-actions {
        display: flex;
        gap: 15px;
        margin-bottom: 20px;
      }

      .videos-list {
        margin-top: 20px;
      }

      .video-grid {
        display: grid;
        gap: 15px;
        margin-top: 15px;
      }

      .video-item {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 15px;
        border: 1px solid #eee;
        border-radius: 8px;
        background-color: #f9f9f9;
      }

      .video-thumbnail {
        width: 60px;
        height: 60px;
        background-color: #00005E;
        border-radius: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 24px;
      }

      .video-info {
        flex: 1;
      }

      .video-info h4 {
        margin: 0 0 5px 0;
        font-size: 16px;
        color: #333;
      }

      .video-info p {
        margin: 0;
        color: #666;
        font-size: 14px;
      }

      .video-actions .btn-sm {
        padding: 5px 10px;
        font-size: 12px;
      }

      .upload-video {
        margin-top: 20px;
      }

      .upload-video h3 {
        margin-bottom: 20px;
        color: #333;
      }

      .form-actions {
        display: flex;
        gap: 10px;
        justify-content: flex-end;
        margin-top: 20px;
      }

      .loading-competitions {
        text-align: center;
        padding: 20px;
        color: #666;
      }

      .loading-competitions i {
        font-size: 24px;
        margin-bottom: 10px;
        color: var(--primary-color);
      }

      .no-competitions {
        text-align: center;
        padding: 20px;
        color: #666;
      }

      .no-competitions i {
        font-size: 48px;
        margin-bottom: 15px;
        color: #ccc;
      }

      /* Estilos para o modal de visualização de vídeo */
      .video-viewer .modal-content {
        max-width: 900px;
        width: 90%;
      }

      .video-container {
        margin-bottom: 20px;
        border-radius: 8px;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .video-container video {
        width: 100%;
        height: auto;
        display: block;
      }

      .video-details {
        padding: 20px 0;
      }

      .video-details h3 {
        color: #00005E;
        margin-bottom: 10px;
        font-size: 1.4em;
      }

      .video-details p {
        color: #666;
        line-height: 1.6;
        margin-bottom: 15px;
      }

      .video-meta {
        display: flex;
        gap: 20px;
        flex-wrap: wrap;
      }

      .video-meta span {
        background-color: #f0f0f0;
        padding: 5px 12px;
        border-radius: 20px;
        font-size: 0.9em;
        color: #555;
      }

      .video-actions {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
      }

              .video-actions .btn {
          flex: 1;
          min-width: 80px;
        }

        /* Estilos para nova lista de vídeos */
        .videos-grid {
          display: grid;
          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
          gap: 20px;
          padding: 20px 0;
        }

        .video-item {
          background: white;
          border-radius: 12px;
          padding: 20px;
          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
          transition: transform 0.2s ease, box-shadow 0.2s ease;
        }

        .video-item:hover {
          transform: translateY(-2px);
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
        }

        .video-thumbnail {
          text-align: center;
          margin-bottom: 15px;
        }

        .video-thumbnail i {
          font-size: 48px;
          color: var(--primary-color);
          opacity: 0.8;
        }

        .video-info h4 {
          margin: 0 0 8px 0;
          color: var(--dark-color);
          font-size: 16px;
          font-weight: 600;
        }

        .video-athlete {
          color: var(--primary-color);
          font-weight: 500;
          margin: 0 0 5px 0;
          font-size: 14px;
        }

        .video-time {
          color: #666;
          font-size: 12px;
          margin: 0 0 5px 0;
        }

        .video-datetime {
          color: #888;
          font-size: 11px;
          margin: 0 0 10px 0;
          font-family: 'Courier New', monospace;
        }

        .video-description {
          color: #666;
          font-size: 13px;
          margin: 0 0 15px 0;
          line-height: 1.4;
        }

        .video-actions {
          display: flex;
          gap: 8px;
          flex-wrap: wrap;
        }

        .video-actions .btn {
          flex: 1;
          min-width: 80px;
          font-size: 12px;
          padding: 6px 12px;
        }

      @media (max-width: 768px) {
        .video-viewer .modal-content {
          width: 95%;
          margin: 10px;
        }
        
        .video-container video {
          height: 250px;
        }
        
        .video-meta {
          flex-direction: column;
          gap: 10px;
        }
        
        .video-actions {
          flex-direction: column;
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <aside class="sidebar">
      <div>
        <div class="sidebar-header">
          <img src="/static/img/logo_if.png" alt="logo" width="230px">
        </div>
        <ul class="menu-items">
          <li>
            <a href="#" class="active"
              ><i class="fas fa-th-large"></i> <span data-translate="nav.dashboard">Dashboard</span></a
            >
          </li>
          <li>
            <a href="/treinador/dados/{{treinador.id}}"
              ><i class="fas fa-chart-bar"></i> <span data-translate="nav.dados_gerais">Dados Gerais</span></a
            >
          </li>
          <li>
            <a href="/treinador/treinamentos/{{treinador.id}}"
              ><i class="fas fa-running"></i> <span data-translate="nav.treinamentos">Treinamentos</span></a
            >
          </li>
          <li>
            <a href="/treinador/calendario/{{treinador.id}}"
              ><i class="fas fa-calendar-days"></i> <span data-translate="nav.calendario">Calendário</span></a
            >
          </li>
        </ul>
      </div>
      <div class="sidebar-footer">
        <a href="https://forms.office.com/" target="_blank"
          ><i class="fas fa-question-circle"></i> <span data-translate="nav.ajuda">Ajuda</span></a
        >
        <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt"></i> <span data-translate="nav.sair">Sair</span></a>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Header -->
      <header class="header">
        <div class="user-info">
          <div class="user-avatar">JC</div>
          <div class="user-details">
                            <h4>...</h4>
                          <p>...</p>
          </div>
        </div>
        <div class="search-bar">
          <i class="fas fa-search"></i>
          <input type="text" placeholder="Pesquisar..." />
        </div>
        <div class="header-actions">
          <div class="action-icon" onclick="showNotifications()">
            <i class="fas fa-bell"></i>
          </div>
          <div class="action-icon" onclick="showSettings()">
            <i class="fas fa-cog"></i>
          </div>
        </div>
      </header>

      <!-- Dashboard Grid -->
      <div class="dashboard-grid">
        <div class="card stat-card">
          <h3 data-translate="dashboard.atletas_cadastrados">ATLETAS CADASTRADOS</h3>
          <div class="number">42</div>
          <div class="trend">
            <i class="fas fa-arrow-up"></i>
            <span data-translate="dashboard.tendencia_positiva">+5 desde o último mês</span>
          </div>
        </div>

        <div class="card stat-card" id="treinosConcluidosCard">
          <h3 data-translate="dashboard.treinos_concluidos">TREINOS CONCLUÍDOS</h3>
          <div class="number" id="percentualTreinos">0%</div>
          <div class="trend" id="trendTreinos">
            <i class="fas fa-arrow-up"></i>
            <span id="contagemTreinos" data-translate="dashboard.contagem_treinos">0 de 0 treinos</span>
          </div>
        </div>

        <div class="card version-card">
          <div class="version-header">
            <h3><i class="fas fa-code-branch"></i> <span data-translate="dashboard.notas_versao">Notas da Versão</span></h3>
            <span class="version-badge">v1.0</span>
          </div>
          <div class="version-list">
            <div class="version-item">
              <p>
                <i class="fas fa-plus-circle"></i> <span data-translate="dashboard.notas_versao_item1">Novo sistema de notificações</span>
              </p>
            </div>
            <div class="version-item">
              <p>
                <i class="fas fa-plus-circle"></i> <span data-translate="dashboard.notas_versao_item2">Nova página de benefícios</span>
              </p>
            </div>
            <div class="version-item">
              <p>
                <i class="fas fa-bug"></i> <span data-translate="dashboard.notas_versao_item3">Correção de bugs no módulo de treinamentos</span>
              </p>
            </div>
            <div class="version-item">
              <p>
                <i class="fas fa-tachometer-alt"></i> <span data-translate="dashboard.notas_versao_item4">Melhorias de performance no dashboard</span>
              </p>
            </div>
          </div>
        </div>

        <div class="card diet-card" id="openModal">
          <i class="fas fa-utensils"></i>
          <h3 data-translate="dashboard.anexar_dieta">Anexar Dietas</h3>
          <p data-translate="dashboard.dieta_descricao">Clique para enviar planos alimentares para os atletas</p>
        </div>
        <div class="card diet-card" id="openVideoModal">
          <i class="fas fa-video"></i>
          <h3 data-translate="dashboard.videos">Vídeos</h3>
          <p data-translate="dashboard.videos_descricao">Clique para gerenciar vídeos dos atletas</p>
        </div>
      </div>

      <!-- Chart and Athletes Section -->
      <div class="chart-athletes">
        <div class="card">
          <h3 data-translate="dashboard.grafico_horas_treinamento">Horas de Treinamento</h3>
          <div class="chart-container">
            <canvas id="trainingChart"></canvas>
          </div>
        </div>

        <div class="card">
          <div class="athletes-scroll">
            <h3 data-translate="dashboard.atletas_cadastrados_lista">Atletas Cadastrados</h3>
            <div class="athlete-item">
              <div class="athlete-avatar">AM</div>
              <div class="athlete-details">
                <h4>Ana Mendonça</h4>
                <p data-translate="modalidade.natacao">Natação</p>
              </div>
            </div>
            <div class="athlete-item">
              <div class="athlete-avatar">PS</div>
              <div class="athlete-details">
                <h4>Pedro Silva</h4>
                <p data-translate="modalidade.atletismo">Atletismo</p>
              </div>
            </div>
            <div class="athlete-item">
              <div class="athlete-avatar">CR</div>
              <div class="athlete-details">
                <h4>Carolina Rodrigues</h4>
                <p data-translate="modalidade.ginastica">Ginástica</p>
              </div>
            </div>
            <div class="athlete-item">
              <div class="athlete-avatar">LS</div>
              <div class="athlete-details">
                <h4>Lucas Santos</h4>
                <p data-translate="modalidade.volei">Vôlei</p>
              </div>
            </div>
            <div class="athlete-item">
              <div class="athlete-avatar">MF</div>
              <div class="athlete-details">
                <h4>Mariana Ferreira</h4>
                <p data-translate="modalidade.natacao">Natação</p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Próximos Eventos -->
      <div class="card competitions-card">
        <h3 data-translate="dashboard.proximos_eventos">Próximos Eventos</h3>
        <div id="competitions-container">
          <!-- Competições serão carregadas dinamicamente do banco -->
          <div class="loading-competitions">
            <i class="fas fa-spinner fa-spin"></i>
            <p data-translate="geral.carregando">Carregando competições...</p>
          </div>
        </div>
      </div>
    </main>

    <!-- Modal de Vídeos -->
    <div id="videoModal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2 data-translate="videos.titulo">Gerenciar Vídeos</h2>
          <button class="close-modal" onclick="closeVideoModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div class="video-actions">
            <button class="btn btn-primary" onclick="openUploadVideo()">
              <i class="fas fa-upload"></i> <span data-translate="videos.postar_novo">Postar Novo Vídeo</span>
            </button>
            <button class="btn btn-outline" onclick="viewAllVideos()">
              <i class="fas fa-eye"></i> <span data-translate="videos.ver_todos">Ver Todos os Vídeos</span>
            </button>
          </div>
          
          <div class="videos-list" id="videosList" style="display: none;">
            <h3 data-translate="videos.disponiveis">Vídeos Disponíveis</h3>
            <div class="video-grid">
              <div class="video-item">
                <div class="video-thumbnail">
                  <i class="fas fa-play-circle"></i>
                </div>
                <div class="video-info">
                  <h4>Treino de Natação - Ana Mendonça</h4>
                  <p>Postado há 2 dias</p>
                </div>
                <div class="video-actions">
                  <button class="btn btn-sm btn-primary" onclick="viewVideo(1)"><span data-translate="videos.visualizar">Visualizar</span></button>
                  <button class="btn btn-sm btn-outline" onclick="editVideo(1)"><span data-translate="videos.editar">Editar</span></button>
                  <button class="btn btn-sm btn-danger" onclick="deleteVideo(1)"><span data-translate="videos.excluir">Excluir</span></button>
                </div>
              </div>
              <div class="video-item">
                <div class="video-thumbnail">
                  <i class="fas fa-play-circle"></i>
                </div>
                <div class="video-info">
                  <h4>Análise Técnica - Pedro Silva</h4>
                  <p>Postado há 1 semana</p>
                </div>
                <div class="video-actions">
                  <button class="btn btn-sm btn-primary" onclick="viewVideo(2)"><span data-translate="videos.visualizar">Visualizar</span></button>
                  <button class="btn btn-sm btn-outline" onclick="editVideo(2)"><span data-translate="videos.editar">Editar</span></button>
                  <button class="btn btn-sm btn-danger" onclick="deleteVideo(2)"><span data-translate="videos.excluir">Excluir</span></button>
                </div>
              </div>
            </div>
          </div>
          
          <div class="upload-video" id="uploadVideo" style="display: none;">
            <h3>Postar Novo Vídeo</h3>
            <form id="videoForm" enctype="multipart/form-data">
              <div class="form-group">
                <label for="videoTitle">Título do Vídeo</label>
                <input type="text" id="videoTitle" required>
              </div>
              <div class="form-group">
                <label for="videoDescription">Descrição</label>
                <textarea id="videoDescription" rows="3"></textarea>
              </div>
              <div class="form-group">
                <label for="videoFile">Arquivo de Vídeo</label>
                <input type="file" id="videoFile" accept="video/*" required>
              </div>
              <div class="form-group">
                <label for="videoAthlete">Atleta (opcional)</label>
                <select id="videoAthlete">
                  <option value="">Selecione um atleta</option>
                  <option value="1">Ana Mendonça</option>
                  <option value="2">Pedro Silva</option>
                  <option value="3">Carolina Rodrigues</option>
                  <option value="4">Lucas Santos</option>
                  <option value="5">Mariana Ferreira</option>
                </select>
              </div>
              <div class="form-actions">
                <button type="button" class="btn btn-outline" onclick="closeUploadVideo()">Cancelar</button>
                <button type="submit" class="btn btn-primary">Postar Vídeo</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal de Visualização de Vídeo -->
    <div id="videoViewModal" class="modal">
      <div class="modal-content video-viewer">
        <div class="modal-header">
          <h2 id="videoViewTitle">Visualizar Vídeo</h2>
          <button class="close-modal" onclick="closeVideoViewModal()">&times;</button>
        </div>
        <div class="modal-body">
          <div class="video-container">
            <video id="videoPlayer" controls width="100%" height="400" preload="metadata">
              <source id="videoSource" src="" type="video/mp4">
              Seu navegador não suporta o elemento de vídeo.
            </video>
          </div>
          <div class="video-details">
            <h3 id="videoViewDetailsTitle">Título do Vídeo</h3>
            <p id="videoViewDescription">Descrição do vídeo...</p>
            <div class="video-meta">
              <span id="videoViewDate">Data de postagem</span>
              <span id="videoViewAthlete">Atleta relacionado</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="dietModal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Anexar Dieta</h2>
          <button class="close-modal">&times;</button>
        </div>
        <div class="form-group">
          <label for="athlete">Selecionar Atleta</label>
          <select id="athlete">
            <option value="">Selecione um atleta</option>
            <option value="1">Ana Mendonça - Natação</option>
            <option value="2">Pedro Silva - Atletismo</option>
            <option value="3">Carolina Rodrigues - Ginástica</option>
            <option value="4">Lucas Santos - Vôlei</option>
            <option value="5">Mariana Ferreira - Natação</option>
          </select>
        </div>
        <div class="form-group">
          <label for="dietFile">Enviar Arquivo de Dieta</label>
          <input type="file" id="dietFile" accept=".pdf,.doc,.docx" />
        </div>
        <div class="modal-actions">
          <button class="btn btn-outline" onclick="closeDietModal()">Cancelar</button>
          <button class="btn btn-primary" onclick="sendDiet()">Enviar Dieta</button>
        </div>
      </div>
    </div>

    <!-- Scripts da API -->
    <script src="../../frontend-config.js"></script>
    <script src="../../dashboard-treinador.js"></script>
    <script src="../../personalizar-usuario.js"></script>
    <script src="../../notificacoes.js"></script>
    <script src="../../traducoes.js"></script>

    <script>
      // Abrir modal
      document
        .getElementById("openModal")
        .addEventListener("click", function () {
          document.getElementById("dietModal").style.display = "flex";
        });

      // Fechar modal
      document
        .querySelector(".close-modal")
        .addEventListener("click", function () {
          document.getElementById("dietModal").style.display = "none";
        });

      // Fechar modal clicando fora
      window.addEventListener("click", function (event) {
        if (event.target == document.getElementById("dietModal")) {
          document.getElementById("dietModal").style.display = "none";
        }
        if (event.target == document.getElementById("videoModal")) {
          document.getElementById("videoModal").style.display = "none";
        }
      });

      // Abrir modal de vídeos
      document.getElementById("openVideoModal").addEventListener("click", function() {
        document.getElementById("videoModal").style.display = "flex";
      });

      // Gráfico de treinamento será atualizado dinamicamente com dados reais
      let trainingChart = null;
      
      function inicializarGrafico() {
      const ctx = document.getElementById("trainingChart").getContext("2d");
        
        // Obter traduções atuais
        const idiomaAtual = window.sistemaIdiomas ? window.sistemaIdiomas.obterIdiomaAtual() : 'pt';
        const traducoes = {
          pt: {
            label: "Horas de Treinamento",
            yTitle: "Horas de Treinamento",
            meses: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"]
          },
          en: {
            label: "Training Hours",
            yTitle: "Training Hours",
            meses: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
          },
          es: {
            label: "Horas de Entrenamiento",
            yTitle: "Horas de Entrenamiento",
            meses: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
          }
        };
        
        const traducao = traducoes[idiomaAtual] || traducoes.pt;
        
        trainingChart = new Chart(ctx, {
        type: "bar",
        data: {
            labels: traducao.meses,
            datasets: [{
              label: traducao.label,
              data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              backgroundColor: "#00005E",
              borderColor: "#00005E",
              borderWidth: 1,
            }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                  text: traducao.yTitle,
              },
            },
          },
        },
      });
        
        // Tornar o gráfico globalmente acessível
        window.chartHorasTreinamento = trainingChart;
        
        // Função para atualizar gráfico quando idioma mudar
        window.atualizarGraficoIdioma = function() {
          if (trainingChart) {
            const idiomaAtual = window.sistemaIdiomas ? window.sistemaIdiomas.obterIdiomaAtual() : 'pt';
            const traducoes = {
              pt: {
                label: "Horas de Treinamento",
                yTitle: "Horas de Treinamento",
                meses: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"]
              },
              en: {
                label: "Training Hours",
                yTitle: "Training Hours",
                meses: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]
              },
              es: {
                label: "Horas de Entrenamiento",
                yTitle: "Horas de Entrenamiento",
                meses: ["Ene", "Feb", "Mar", "Abr", "May", "Jun", "Jul", "Ago", "Sep", "Oct", "Nov", "Dic"]
              }
            };
            
            const traducao = traducoes[idiomaAtual] || traducoes.pt;
            
            // Atualizar labels e título
            trainingChart.data.labels = traducao.meses;
            trainingChart.data.datasets[0].label = traducao.label;
            trainingChart.options.scales.y.title.text = traducao.yTitle;
            trainingChart.update();
            
            console.log(`🔄 Gráfico atualizado para idioma: ${idiomaAtual}`);
          }
        };
        
        // Carregar dados salvos do localStorage
        carregarDadosGrafico();
        console.log('🔄 Carregando estatísticas iniciais...');
        
        // Carregar estatísticas imediatamente
        carregarEstatisticasTreinos();
        
        // Inicializar contadores para detecção de novos cadastros
        inicializarContadoresCadastros();
      }
      
      // Função para carregar dados do gráfico do localStorage
      function carregarDadosGrafico() {
        try {
          const dadosSalvos = localStorage.getItem('horas_treinamento_mensal');
          if (dadosSalvos) {
            const horasPorMes = JSON.parse(dadosSalvos);
            console.log('📊 Dados do gráfico carregados do localStorage:', horasPorMes);
            
            // Atualizar gráfico com dados salvos
            if (trainingChart) {
              trainingChart.data.datasets[0].data = Object.values(horasPorMes);
              trainingChart.update();
              console.log('✅ Gráfico atualizado com dados salvos!');
            }
          }
        } catch (error) {
          console.error('❌ Erro ao carregar dados do gráfico:', error);
        }
      }

      // Função para carregar e exibir estatísticas dos treinos
      function carregarEstatisticasTreinos() {
        try {
          console.log('🔄 Iniciando carregamento de estatísticas...');
          console.log('🔄 Função chamada em:', new Date().toLocaleTimeString());
          
          const estatisticasSalvas = localStorage.getItem('estatisticas_treinos');
          console.log('📦 Dados do localStorage:', estatisticasSalvas);
          
          if (estatisticasSalvas) {
            const estatisticas = JSON.parse(estatisticasSalvas);
            console.log('📊 Estatísticas dos treinos carregadas:', estatisticas);
            
            // Atualizar elementos da interface
            const percentualElement = document.getElementById('percentualTreinos');
            const contagemElement = document.getElementById('contagemTreinos');
            const trendElement = document.getElementById('trendTreinos');
            
            console.log('🔍 Elementos encontrados:', {
              percentual: percentualElement,
              contagem: contagemElement,
              trend: trendElement
            });
            
            if (percentualElement && contagemElement && trendElement) {
              console.log('📝 Atualizando percentual para:', `${estatisticas.percentual}%`);
              console.log('📝 Atualizando contagem para:', `${estatisticas.concluidos} de ${estatisticas.total} treinos`);
              
              // Verificar conteúdo antes da atualização
              console.log('🔍 ANTES da atualização:');
              console.log('  - Percentual:', percentualElement.textContent);
              console.log('  - Contagem:', contagemElement.textContent);
              
              // Limpar conteúdo anterior para evitar duplicação
              percentualElement.innerHTML = '';
              contagemElement.innerHTML = '';
              
              // Verificar se foi limpo
              console.log('🔍 APÓS limpeza:');
              console.log('  - Percentual:', percentualElement.textContent);
              console.log('  - Contagem:', contagemElement.textContent);
              
              // Atualizar percentual imediatamente
              percentualElement.textContent = `${estatisticas.percentual}%`;
              console.log('🎯 Percentual atualizado na interface:', percentualElement.textContent);
              
              // Atualizar contagem imediatamente
              contagemElement.textContent = `${estatisticas.concluidos} de ${estatisticas.total} treinos`;
              console.log('🎯 Contagem atualizada na interface:', contagemElement.textContent);
              
              // Forçar reflow do DOM
              percentualElement.offsetHeight;
              contagemElement.offsetHeight;
              
              // Verificar se a atualização foi mantida
              console.log('🔍 VERIFICAÇÃO FINAL:');
              console.log('  - Percentual na interface:', percentualElement.textContent);
              console.log('  - Contagem na interface:', contagemElement.textContent);
              console.log('  - Dados originais:', estatisticas);
              
              // Verificar se há algum problema de referência
              const percentualVerificado = document.getElementById('percentualTreinos');
              const contagemVerificada = document.getElementById('contagemTreinos');
              console.log('🔍 Verificação de referência:');
              console.log('  - Elemento percentual é o mesmo:', percentualElement === percentualVerificado);
              console.log('  - Elemento contagem é o mesmo:', contagemElement === contagemVerificado);
              
              // Configurar um observer para detectar quando o 100% volta
              const observer = new MutationObserver((mutations) => {
                mutations.forEach((mutation) => {
                  if (mutation.type === 'childList' || mutation.type === 'characterData') {
                    const currentPercentual = percentualElement.textContent;
                    if (currentPercentual === '100%') {
                      // BLOQUEAR a mudança para 100% e restaurar 75% (sem logs excessivos)
                      percentualElement.textContent = `${estatisticas.percentual}%`;
                      contagemElement.textContent = `${estatisticas.concluidos} de ${estatisticas.total} treinos`;
                      
                      // Aplicar cor azul novamente
                      percentualElement.style.setProperty('color', '#00005e', 'important');
                      trendElement.style.setProperty('color', '#00005e', 'important');
                      
                      // Log único quando bloquear
                      console.log('🛡️ Observer: 100% bloqueado e restaurado para', estatisticas.percentual + '%');
                    }
                  }
                });
              });
              
              observer.observe(percentualElement, {
                childList: true,
                characterData: true,
                subtree: true
              });
              
              console.log('🛡️ Sistema de proteção ativado - 100% será bloqueado automaticamente');;
              
              // Aplicar cor azul para todas as porcentagens
              const percentual = parseFloat(estatisticas.percentual);
              console.log('🎯 Percentual numérico:', percentual);
              
              // Remover classes anteriores
              percentualElement.classList.remove('percentual-verde', 'percentual-amarelo', 'percentual-vermelho');
              trendElement.classList.remove('trend-verde', 'trend-amarelo', 'trend-vermelho');
              
              // Aplicar cor azul para todas as porcentagens
              percentualElement.style.setProperty('color', '#00005e', 'important'); // Azul escuro
              trendElement.style.setProperty('color', '#00005e', 'important'); // Azul escuro
              console.log('🎨 Cor aplicada: Azul para todas as porcentagens');
              
              console.log('✅ Estatísticas dos treinos atualizadas na interface!');
            } else {
              console.error('❌ Elementos não encontrados na interface');
            }
          } else {
            console.log('⚠️ Nenhuma estatística encontrada no localStorage');
          }
        } catch (error) {
          console.error('❌ Erro ao carregar estatísticas dos treinos:', error);
        }
      }
      
      // Função para atualizar gráfico com novos dados
      function atualizarGraficoComDados(dadosHoras) {
        try {
          if (trainingChart) {
            trainingChart.data.datasets[0].data = Object.values(dadosHoras);
            trainingChart.update();
            console.log('✅ Gráfico atualizado com novos dados:', dadosHoras);
          }
        } catch (error) {
          console.error('❌ Erro ao atualizar gráfico:', error);
        }
      }
      
      // Tornar função globalmente acessível
      window.atualizarGraficoHoras = atualizarGraficoComDados;
      
      // Escutar mensagens de outras páginas
      window.addEventListener('message', function(event) {
        console.log('📨 Mensagem recebida:', event.data);
        
        if (event.data.type === 'atualizar_estatisticas') {
          console.log('📊 Atualizando estatísticas recebidas:', event.data.estatisticas);
          localStorage.setItem('estatisticas_treinos', JSON.stringify(event.data.estatisticas));
          carregarEstatisticasTreinos();
        } else if (event.data.type === 'atualizar_grafico') {
          console.log('📈 Atualizando gráfico recebido');
          carregarDadosGrafico();
        }
      });

      // Função de teste para estatísticas
      function testarEstatisticas() {
        console.log('🧪 Testando estatísticas...');
        
        // Simular estatísticas de teste
        const estatisticasTeste = {
          total: 5,
          concluidos: 2,
          percentual: '40.0',
          pendentes: 3
        };
        
        console.log('📊 Estatísticas de teste:', estatisticasTeste);
        
        // Salvar no localStorage
        localStorage.setItem('estatisticas_treinos', JSON.stringify(estatisticasTeste));
        
        // Atualizar interface
        carregarEstatisticasTreinos();
        
        console.log('✅ Teste concluído!');
      }
      
      // Função para forçar atualização das estatísticas
      function forcarAtualizacaoEstatisticas() {
        console.log('🔄 Forçando atualização das estatísticas...');
        
        // Limpar localStorage
        localStorage.removeItem('estatisticas_treinos');
        
        // Recarregar estatísticas
        carregarEstatisticasTreinos();
        
        console.log('✅ Atualização forçada concluída!');
      }

      // Verificar atualizações do localStorage periodicamente
      setInterval(() => {
        const timestamp = localStorage.getItem('grafico_atualizar');
        if (timestamp && Date.now() - parseInt(timestamp) < 5000) {
          console.log('🔄 Atualização detectada, recarregando dados...');
          carregarDadosGrafico();
          console.log('🔄 Chamando carregarEstatisticasTreinos...');
          carregarEstatisticasTreinos();
          localStorage.removeItem('grafico_atualizar');
        }
        
        // Verificar se o 100% voltou (reduzido para evitar spam)
        const percentualElement = document.getElementById('percentualTreinos');
        if (percentualElement && percentualElement.textContent === '100%') {
          // BLOQUEAR automaticamente e restaurar 75% (sem logs excessivos)
          const estatisticasSalvas = localStorage.getItem('estatisticas_treinos');
          if (estatisticasSalvas) {
            const estatisticas = JSON.parse(estatisticasSalvas);
            
            percentualElement.textContent = `${estatisticas.percentual}%`;
            const contagemElement = document.getElementById('contagemTreinos');
            if (contagemElement) {
              contagemElement.textContent = `${estatisticas.concluidos} de ${estatisticas.total} treinos`;
            }
            
            // Aplicar cor azul
            percentualElement.style.setProperty('color', '#00005e', 'important');
            const trendElement = document.getElementById('trendTreinos');
            if (trendElement) {
              trendElement.style.setProperty('color', '#00005e', 'important');
            }
            
            // Log único quando bloquear
            console.log('🛡️ 100% bloqueado e restaurado para', estatisticas.percentual + '%');
          }
        }
        
        // Atualizar tempo das notificações a cada 2 segundos
        atualizarTempoNotificacoes();
        
        // Detectar novos cadastros a cada 5 segundos
        detectarNovosCadastros();
             }, 1000); // Otimizado para 1 segundo
      
      // Inicializar gráfico
      inicializarGrafico();

      // Função de logout
      function logout() {
        if (confirm('Tem certeza que deseja sair?')) {
          window.location.href = '/';
        }
      }

      // Função para detectar novos cadastros e criar notificações
      function detectarNovosCadastros() {
        try {
          const agora = new Date();
          const notificacoes = [];
          
          // Verificar se há novos alunos cadastrados
          const alunosAtuais = localStorage.getItem('alunos_cadastrados') || '0';
          const alunosAnteriores = localStorage.getItem('alunos_cadastrados_anterior') || '0';
          
          if (parseInt(alunosAtuais) > parseInt(alunosAnteriores)) {
            const novosAlunos = parseInt(alunosAtuais) - parseInt(alunosAnteriores);
            notificacoes.push({
              id: Date.now() + 1,
              message: `👨‍🎓 ${novosAlunos} novo(s) aluno(s) cadastrado(s) no sistema`,
              timestamp: agora.getTime(),
              time: formatarTempoRelativo(agora),
              read: false,
              tipo: 'sucesso',
              categoria: 'cadastro'
            });
            
            // Atualizar contador anterior
            localStorage.setItem('alunos_cadastrados_anterior', alunosAtuais);
          }
          
          // Verificar se há novos professores cadastrados
          const professoresAtuais = localStorage.getItem('professores_cadastrados') || '0';
          const professoresAnteriores = localStorage.getItem('professores_cadastrados_anterior') || '0';
          
          if (parseInt(professoresAtuais) > parseInt(professoresAnteriores)) {
            const novosProfessores = parseInt(professoresAtuais) - parseInt(professoresAnteriores);
            notificacoes.push({
              id: Date.now() + 2,
              message: `👨‍🏫 ${novosProfessores} novo(s) professor(es) cadastrado(s) no sistema`,
              timestamp: agora.getTime(),
              time: formatarTempoRelativo(agora),
              read: false,
              tipo: 'info',
              categoria: 'cadastro'
            });
            
            // Atualizar contador anterior
            localStorage.setItem('professores_cadastrados_anterior', professoresAtuais);
          }
          
          // Verificar se há novos treinos criados
          const treinosAtuais = localStorage.getItem('total_treinos') || '0';
          const treinosAnteriores = localStorage.getItem('total_treinos_anterior') || '0';
          
          if (parseInt(treinosAtuais) > parseInt(treinosAnteriores)) {
            const novosTreinos = parseInt(treinosAtuais) - parseInt(treinosAnteriores);
            notificacoes.push({
              id: Date.now() + 3,
              message: `🏋️ ${novosTreinos} novo(s) treino(s) criado(s) no sistema`,
              timestamp: agora.getTime(),
              time: formatarTempoRelativo(agora),
              read: false,
              tipo: 'info',
              categoria: 'treino'
            });
            
            // Atualizar contador anterior
            localStorage.setItem('total_treinos_anterior', treinosAtuais);
          }
          
          // Se houver novas notificações, adicionar às existentes
          if (notificacoes.length > 0) {
            const notificacoesExistentes = JSON.parse(localStorage.getItem('notificacoes_sistema') || '[]');
            const todasNotificacoes = [...notificacoes, ...notificacoesExistentes];
            
            // Manter apenas as últimas 20 notificações
            if (todasNotificacoes.length > 20) {
              todasNotificacoes.splice(20);
            }
            
            localStorage.setItem('notificacoes_sistema', JSON.stringify(todasNotificacoes));
            
            // Mostrar notificação toast
            mostrarNotificacaoToast(notificacoes[0].message);
            
            console.log('🔔 Novas notificações de cadastro criadas:', notificacoes);
          }
          
        } catch (error) {
          console.error('❌ Erro ao detectar novos cadastros:', error);
        }
      }
      
      // Função para mostrar notificação toast
      function mostrarNotificacaoToast(mensagem) {
        try {
          // Remover toast existente
          const toastExistente = document.querySelector('.toast-notification');
          if (toastExistente) {
            toastExistente.remove();
          }
          
          // Criar novo toast
          const toast = document.createElement('div');
          toast.className = 'toast-notification';
          toast.innerHTML = `
            <div class="toast-content">
              <span>${mensagem}</span>
              <button onclick="this.parentElement.parentElement.remove()">&times;</button>
          </div>
        `;
        
          document.body.appendChild(toast);
          
          // Remover automaticamente após 5 segundos
          setTimeout(() => {
            if (toast.parentElement) {
              toast.remove();
            }
          }, 5000);
          
        } catch (error) {
          console.error('❌ Erro ao mostrar toast:', error);
        }
      }
      
      // Função para atualizar notificações existentes com novo tempo
      function atualizarTempoNotificacoes() {
        try {
          const notificacoesSalvas = localStorage.getItem('notificacoes_sistema');
          if (notificacoesSalvas) {
            const notificacoes = JSON.parse(notificacoesSalvas);
            
            // Atualizar tempo de cada notificação
            notificacoes.forEach(notif => {
              if (notif.timestamp) {
                const data = new Date(notif.timestamp);
                notif.time = formatarTempoRelativo(data);
              }
            });
            
            // Salvar notificações atualizadas
            localStorage.setItem('notificacoes_sistema', JSON.stringify(notificacoes));
          }
        } catch (error) {
          console.error('❌ Erro ao atualizar tempo das notificações:', error);
        }
      }

      // Função para gerar notificações reais baseadas nos dados do sistema
      function gerarNotificacoesReais() {
        try {
          const notificacoes = [];
          const agora = new Date();
          
          // Verificar estatísticas dos treinos
          const estatisticas = localStorage.getItem('estatisticas_treinos');
          if (estatisticas) {
            const stats = JSON.parse(estatisticas);
            
            // Notificação baseada no percentual de conclusão
            if (stats.percentual >= 80) {
              notificacoes.push({
                id: 1,
                message: `🎯 Excelente! ${stats.percentual}% dos treinos foram concluídos`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'sucesso',
                categoria: 'estatistica'
              });
            } else if (stats.percentual >= 50) {
              notificacoes.push({
                id: 2,
                message: `📊 ${stats.percentual}% dos treinos concluídos - ${stats.pendentes} ainda pendentes`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'info',
                categoria: 'estatistica'
              });
            } else {
              notificacoes.push({
                id: 3,
                message: `⚠️ Apenas ${stats.percentual}% dos treinos concluídos - Foco nos treinos pendentes!`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'aviso',
                categoria: 'estatistica'
              });
            }
          }
          
          // Verificar horas de treinamento
          const horasTreinamento = localStorage.getItem('horas_treinamento_mensal');
          if (horasTreinamento) {
            const horas = JSON.parse(horasTreinamento);
            const totalHoras = Object.values(horas).reduce((sum, hora) => sum + hora, 0);
            
            if (totalHoras > 0) {
              notificacoes.push({
                id: 4,
                message: `⏱️ Total de ${totalHoras.toFixed(1)} horas de treinamento este mês`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'info',
                categoria: 'horas'
              });
            }
          }
          
          // Verificar se há treinos recentes
          const treinosRecentes = localStorage.getItem('trainings');
          if (treinosRecentes) {
            const treinos = JSON.parse(treinosRecentes);
            const treinosConcluidosHoje = treinos.filter(t => 
              t.completed && 
              new Date(t.date).toDateString() === new Date().toDateString()
            );
            
            if (treinosConcluidosHoje.length > 0) {
              notificacoes.push({
                id: 5,
                message: `✅ ${treinosConcluidosHoje.length} treino(s) concluído(s) hoje`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'sucesso',
                categoria: 'treino'
              });
            }
          }
          
          // Verificar eventos do calendário
          const eventosRecentes = localStorage.getItem('eventos_calendario');
          if (eventosRecentes) {
            const eventos = JSON.parse(eventosRecentes);
            const eventosProximos = eventos.filter(e => {
              // Usar data exata do sistema (sem conversões)
              const dataEvento = usarDataExata(e.data);
              const agora = new Date();
              const diffDias = (dataEvento - agora) / (1000 * 60 * 60 * 24);
              return diffDias >= 0 && diffDias <= 7; // Eventos nos próximos 7 dias
            });
            
            if (eventosProximos.length > 0) {
              notificacoes.push({
                id: 6,
                message: `📅 ${eventosProximos.length} evento(s) próximo(s) esta semana`,
                timestamp: agora.getTime(),
                time: formatarTempoRelativo(agora),
                read: false,
                tipo: 'info',
                categoria: 'calendario'
              });
            }
          }
          
          // Salvar notificações no localStorage
          localStorage.setItem('notificacoes_sistema', JSON.stringify(notificacoes));
          
          console.log('🔔 Notificações reais geradas:', notificacoes);
          return notificacoes;
          
        } catch (error) {
          console.error('❌ Erro ao gerar notificações:', error);
          return [];
        }
      }
      
      // Função para formatar tempo relativo (ex: "há 5 minutos", "há 2 horas")
      function formatarTempoRelativo(data) {
        const agora = new Date();
        const diffMs = agora.getTime() - data.getTime();
        const diffMin = Math.floor(diffMs / (1000 * 60));
        const diffHora = Math.floor(diffMs / (1000 * 60 * 60));
        const diffDia = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        
        if (diffMin < 1) {
          return 'Agora mesmo';
        } else if (diffMin < 60) {
          return `há ${diffMin} minuto${diffMin > 1 ? 's' : ''}`;
        } else if (diffHora < 24) {
          return `há ${diffHora} hora${diffHora > 1 ? 's' : ''}`;
        } else if (diffDia < 7) {
          return `há ${diffDia} dia${diffDia > 1 ? 's' : ''}`;
        } else {
          return data.toLocaleDateString('pt-BR');
        }
      }
      
      // Função para usar a data exata do sistema (sem conversões)
      function usarDataExata(dataString) {
        try {
          // Se a data já é um objeto Date, retornar como está
          if (dataString instanceof Date) {
            return dataString;
          }
          
          // Se é uma string, usar exatamente como foi inserida
          if (typeof dataString === 'string') {
            // Para datas no formato YYYY-MM-DD, criar data local exata
            if (/^\d{4}-\d{2}-\d{2}$/.test(dataString)) {
              const [ano, mes, dia] = dataString.split('-').map(Number);
              // Criar data no fuso horário local sem conversões
              // Usar 00:00:00 para garantir que a data seja exata
              return new Date(ano, mes - 1, dia, 0, 0, 0);
            }
            
            // Para outros formatos, usar como está
            return new Date(dataString);
          }
          
          // Se não for string nem Date, tentar criar uma nova data
          return new Date(dataString);
          
        } catch (error) {
          console.error('❌ Erro ao processar data:', error, 'Data original:', dataString);
          // Fallback para o método original
          return new Date(dataString);
        }
      }
      
      // Função para inicializar contadores de cadastros
      function inicializarContadoresCadastros() {
        try {
          // Inicializar contadores se não existirem
          if (!localStorage.getItem('alunos_cadastrados_anterior')) {
            localStorage.setItem('alunos_cadastrados_anterior', '0');
          }
          if (!localStorage.getItem('professores_cadastrados_anterior')) {
            localStorage.setItem('professores_cadastrados_anterior', '0');
          }
          if (!localStorage.getItem('total_treinos_anterior')) {
            localStorage.setItem('total_treinos_anterior', '0');
          }
          
          // Definir contadores atuais baseados nos dados do dashboard
          const atletasElement = document.querySelector('.stat-card:nth-child(1) .number');
          if (atletasElement) {
            const atletasAtuais = atletasElement.textContent.replace(/\D/g, '') || '0';
            localStorage.setItem('alunos_cadastrados', atletasAtuais);
          }
          
          const treinosElement = document.querySelector('.stat-card:nth-child(2) .number');
          if (treinosElement) {
            const treinosAtuais = treinosElement.textContent.replace(/\D/g, '') || '0';
            localStorage.setItem('total_treinos', treinosAtuais);
          }
          
          console.log('✅ Contadores de cadastros inicializados');
          
        } catch (error) {
          console.error('❌ Erro ao inicializar contadores:', error);
        }
      }

      // Funções para os botões de ação do header
      function showNotifications() {
        // Usar o sistema de notificações reais
        if (window.sistemaNotificacoes) {
          window.sistemaNotificacoes.abrirPainel();
        } else {
          console.log('⚠️ Sistema de notificações não disponível');
        }
      }

      function showSettings() {
        const idiomaAtual = window.sistemaIdiomas ? window.sistemaIdiomas.obterIdiomaAtual() : 'pt';
        
        const modal = document.createElement('div');
        modal.className = 'modal';
        modal.style.display = 'flex';
        modal.innerHTML = `
          <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
              <h2 data-translate="config.titulo">Configurações do Sistema</h2>
              <button class="close-modal" onclick="this.parentElement.parentElement.parentElement.remove()" data-translate-title="geral.fechar">&times;</button>
            </div>
            <div class="settings-content">
              <div class="form-group">
                <label data-translate="config.notificacoes_email">Notificações por Email</label>
                <input type="checkbox" checked>
              </div>
              <div class="form-group">
                <label data-translate="config.notificacoes_push">Notificações Push</label>
                <input type="checkbox" checked>
              </div>
              <div class="form-group">
                <label data-translate="config.idioma">Idioma</label>
                <select id="selectIdioma" onchange="alterarIdioma(this.value)">
                  <option value="pt" ${idiomaAtual === 'pt' ? 'selected' : ''} data-translate="config.portugues">Português</option>
                  <option value="en" ${idiomaAtual === 'en' ? 'selected' : ''} data-translate="config.ingles">English</option>
                  <option value="es" ${idiomaAtual === 'es' ? 'selected' : ''} data-translate="config.espanhol">Español</option>
                </select>
              </div>
              <div class="form-group">
                <label data-translate="config.tema">Tema</label>
                <select>
                  <option data-translate="config.claro">Claro</option>
                  <option data-translate="config.escuro">Escuro</option>
                </select>
              </div>
            </div>
            <div class="modal-actions">
              <button class="btn btn-outline" onclick="this.parentElement.parentElement.parentElement.remove()" data-translate="config.cancelar">Cancelar</button>
              <button class="btn btn-primary" onclick="salvarConfiguracoes()" data-translate="config.salvar">Salvar</button>
            </div>
          </div>
        `;
        
        document.body.appendChild(modal);
        
        // Aplicar traduções ao modal
        if (window.sistemaIdiomas) {
          window.sistemaIdiomas.aplicarIdioma(window.sistemaIdiomas.obterIdiomaAtual());
        }
        
        // Fechar modal ao clicar fora
        modal.addEventListener('click', function(e) {
          if (e.target === modal) {
            modal.remove();
          }
        });
      }

      function salvarConfiguracoes() {
        // Aqui você pode adicionar lógica para salvar outras configurações
        console.log('✅ [CONFIG] Configurações salvas');
        
        // Fechar modal
        const modal = document.querySelector('.modal');
        if (modal) {
          modal.remove();
        }
      }

      // Funções para o modal de dieta
      function closeDietModal() {
        document.getElementById("dietModal").style.display = "none";
      }

      function sendDiet() {
        const athlete = document.getElementById('athlete').value;
        const dietFile = document.getElementById('dietFile').files[0];
        
        if (!athlete) {
          alert('Por favor, selecione um atleta.');
          return;
        }
        
        if (!dietFile) {
          alert('Por favor, selecione um arquivo de dieta.');
          return;
        }
        
        alert(`Dieta enviada com sucesso para ${athlete}!`);
        document.getElementById("dietModal").style.display = "none";
        
        // Limpar formulário
        document.getElementById('athlete').value = '';
        document.getElementById('dietFile').value = '';
      }

      // Funções para o modal de vídeos
      function closeVideoModal() {
        document.getElementById("videoModal").style.display = "none";
        // Resetar visualizações
        document.getElementById("videosList").style.display = "none";
        document.getElementById("uploadVideo").style.display = "none";
        document.getElementById("videoForm").reset();
      }

      function openUploadVideo() {
        document.getElementById("uploadVideo").style.display = "block";
        document.getElementById("videosList").style.display = "none";
      }

      function openVideosList() {
        document.getElementById("videosList").style.display = "block";
        document.getElementById("uploadVideo").style.display = "none";
        carregarListaVideos();
      }

      // Função para carregar lista de vídeos
      async function carregarListaVideos() {
        try {
          const token = localStorage.getItem('jwt_token');
          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          
          const response = await fetch(`${baseURL}/api/treinador/videos`, {
            method: 'GET',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });
          
          const data = await response.json();
          
          if (data.sucesso) {
            atualizarListaVideos(data.videos);
          } else {
            console.error('Erro ao carregar vídeos:', data.erro);
            document.getElementById('videosList').innerHTML = '<p>Erro ao carregar vídeos.</p>';
          }
          
        } catch (error) {
          console.error('Erro ao carregar lista de vídeos:', error);
          document.getElementById('videosList').innerHTML = '<p>Erro ao carregar vídeos.</p>';
        }
      }

      // Função para atualizar a lista de vídeos na interface
      function atualizarListaVideos(videos) {
        const videosList = document.getElementById('videosList');
        
        if (!videos || videos.length === 0) {
          videosList.innerHTML = `
            <div style="text-align: center; padding: 40px; color: #666;">
              <i class="fas fa-video" style="font-size: 48px; margin-bottom: 16px; opacity: 0.3;"></i>
              <p>Nenhum vídeo postado ainda.</p>
              <small>Use o botão "Postar Novo Vídeo" para começar.</small>
            </div>
          `;
          return;
        }
        
        let html = '<div class="videos-grid">';
        
        videos.forEach(video => {
          const dataUpload = new Date(video.data_upload);
          const tempoRelativo = calcularTempoRelativo(dataUpload);
          const dataHoraCompleta = formatarDataHoraCompleta(dataUpload);
          
          html += `
            <div class="video-item">
              <div class="video-thumbnail">
                <i class="fas fa-play-circle"></i>
              </div>
              <div class="video-info">
                <h4>${video.titulo}</h4>
                <p class="video-athlete">${video.atleta_nome}</p>
                <p class="video-time" title="${dataHoraCompleta}">${tempoRelativo}</p>
                <p class="video-datetime">${dataHoraCompleta}</p>
                ${video.descricao ? `<p class="video-description">${video.descricao}</p>` : ''}
              </div>
              <div class="video-actions">
                <button class="btn btn-primary btn-sm" onclick="visualizarVideo('${video.url_video}', '${video.titulo}', '${video.descricao || ''}', '${video.atleta_nome}', '${dataHoraCompleta}')">
                  <i class="fas fa-eye"></i> Visualizar
                </button>
                <button class="btn btn-outline btn-sm" onclick="editarVideo(${video.id})">
                  <i class="fas fa-edit"></i> Editar
                </button>
                <button class="btn btn-outline btn-sm" onclick="excluirVideo(${video.id})">
                  <i class="fas fa-trash"></i> Excluir
                </button>
              </div>
            </div>
          `;
        });
        
        html += '</div>';
        videosList.innerHTML = html;
      }

      // Função para calcular tempo relativo
      function calcularTempoRelativo(data) {
        const agora = new Date();
        const dataUpload = new Date(data);
        
        // Converter para horário de Brasília (UTC-3)
        const offsetBrasilia = -3 * 60; // -3 horas em minutos
        const agoraBrasilia = new Date(agora.getTime() + (offsetBrasilia * 60000));
        const dataUploadBrasilia = new Date(dataUpload.getTime() + (offsetBrasilia * 60000));
        
        // Normalizar para o início do dia (00:00:00) em Brasília
        const hojeBrasilia = new Date(agoraBrasilia.getFullYear(), agoraBrasilia.getMonth(), agoraBrasilia.getDate());
        const dataUploadNormalizada = new Date(dataUploadBrasilia.getFullYear(), dataUploadBrasilia.getMonth(), dataUploadBrasilia.getDate());
        
        const diffMs = hojeBrasilia - dataUploadNormalizada;
        const diffDias = Math.floor(diffMs / (1000 * 60 * 60 * 24));
        
        // Debug para verificar os valores
        console.log('🕐 [DEBUG] Tempo relativo (Brasília):', {
          agora: agora.toISOString(),
          dataUpload: dataUpload.toISOString(),
          agoraBrasilia: agoraBrasilia.toISOString(),
          dataUploadBrasilia: dataUploadBrasilia.toISOString(),
          hojeBrasilia: hojeBrasilia.toISOString(),
          dataUploadNormalizada: dataUploadNormalizada.toISOString(),
          diffMs: diffMs,
          diffDias: diffDias
        });
        
        if (diffDias === 0) {
          return 'Hoje';
        } else if (diffDias === 1) {
          return 'Ontem';
        } else if (diffDias < 7) {
          return `${diffDias} dias atrás`;
        } else if (diffDias < 30) {
          const semanas = Math.floor(diffDias / 7);
          return semanas === 1 ? '1 semana atrás' : `${semanas} semanas atrás`;
        } else {
          const meses = Math.floor(diffDias / 30);
          return meses === 1 ? '1 mês atrás' : `${meses} meses atrás`;
        }
      }

      // Função para formatar data e hora completa
      function formatarDataHoraCompleta(data) {
        const dataObj = new Date(data);
        
        // Converter para horário de Brasília (UTC-3)
        const offsetBrasilia = -3 * 60; // -3 horas em minutos
        const dataBrasilia = new Date(dataObj.getTime() + (offsetBrasilia * 60000));
        
        const opcoes = {
          year: 'numeric',
          month: '2-digit',
          day: '2-digit',
          hour: '2-digit',
          minute: '2-digit',
          hour12: false,
          timeZone: 'America/Sao_Paulo'
        };
        return dataBrasilia.toLocaleString('pt-BR', opcoes);
      }

      // Função para visualizar vídeo
      function visualizarVideo(url, titulo = 'Vídeo', descricao = '', atletaNome = '', dataUpload = '') {
        console.log('🎥 [VÍDEO] Iniciando visualização:', { url, titulo, descricao, atletaNome, dataUpload });
        
        // Preencher o modal de visualização
        const videoElement = document.getElementById('videoPlayer');
        const videoSource = document.getElementById('videoSource');
        const videoTitle = document.getElementById('videoViewDetailsTitle');
        const videoDescription = document.getElementById('videoViewDescription');
        const videoDate = document.getElementById('videoViewDate');
        const videoAthlete = document.getElementById('videoViewAthlete');
        
        if (!videoElement || !videoSource) {
          console.error('❌ [VÍDEO] Elementos do player não encontrados');
          alert('Erro: Player de vídeo não encontrado');
          return;
        }
        
        // Verificar se a URL do vídeo é válida
        if (!url || url.trim() === '') {
          console.error('❌ [VÍDEO] URL do vídeo inválida:', url);
          alert('Erro: URL do vídeo não disponível');
          return;
        }
        
        console.log('🎥 [VÍDEO] Configurando vídeo com URL:', url);
        
        // Construir URL correta para arquivos locais
        let videoUrl = url;
        if (url.startsWith('/uploads/')) {
          // Para arquivos locais, usar a rota do Flask
          videoUrl = `http://localhost:5000${url}`;
        }
        
        console.log('🎥 [VÍDEO] URL final do vídeo:', videoUrl);
        
        // Configurar o vídeo
        videoSource.src = videoUrl;
        videoElement.load(); // Recarregar o vídeo com a nova fonte
        
        // Adicionar event listeners para debug
        videoElement.addEventListener('loadstart', () => {
          console.log('🎥 [VÍDEO] Iniciando carregamento...');
        });
        
        videoElement.addEventListener('canplay', () => {
          console.log('✅ [VÍDEO] Vídeo pode ser reproduzido');
        });
        
        videoElement.addEventListener('loadeddata', () => {
          console.log('✅ [VÍDEO] Dados do vídeo carregados');
        });
        
        videoElement.addEventListener('error', (e) => {
          console.error('❌ [VÍDEO] Erro ao carregar vídeo:', e);
          console.error('❌ [VÍDEO] Erro details:', videoElement.error);
        });
        
        videoElement.addEventListener('load', () => {
          console.log('✅ [VÍDEO] Vídeo carregado com sucesso');
        });
        
        // Preencher informações
        videoTitle.textContent = titulo;
        videoDescription.textContent = descricao || 'Sem descrição disponível';
        videoDate.textContent = dataUpload || 'Data não disponível';
        videoAthlete.textContent = atletaNome || 'Atleta não especificado';
        
        console.log('🎥 [VÍDEO] Abrindo modal...');
        
        // Abrir o modal
        document.getElementById('videoViewModal').style.display = 'block';
      }

      // Função para editar vídeo (placeholder)
      function editarVideo(videoId) {
        alert(`Funcionalidade de edição será implementada para o vídeo ID: ${videoId}`);
      }

      // Função para excluir vídeo (placeholder)
      function excluirVideo(videoId) {
        if (confirm('Tem certeza que deseja excluir este vídeo? Esta ação não pode ser desfeita.')) {
          console.log('🗑️ [VÍDEO] Iniciando exclusão do vídeo ID:', videoId);
          
          // Obter token de autenticação
          const token = localStorage.getItem('jwt_token');
          if (!token) {
            alert('Erro: Token de autenticação não encontrado');
            return;
          }
          
          // Fazer requisição para excluir o vídeo
          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          fetch(`${baseURL}/api/treinador/videos/${videoId}`, {
            method: 'DELETE',
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          })
          .then(response => response.json())
          .then(data => {
            if (data.sucesso) {
              console.log('✅ [VÍDEO] Vídeo excluído com sucesso');
              alert('Vídeo excluído com sucesso!');
              
              // Recarregar a lista de vídeos
              carregarListaVideos();
            } else {
              console.error('❌ [VÍDEO] Erro ao excluir vídeo:', data.erro);
              alert(`Erro ao excluir vídeo: ${data.erro}`);
            }
          })
          .catch(error => {
            console.error('❌ [VÍDEO] Erro na requisição:', error);
            alert('Erro ao excluir vídeo. Tente novamente.');
          });
        }
      }

      function viewAllVideos() {
        openVideosList();
      }

      function editVideo(videoId) {
        alert(`Editando vídeo ${videoId} - Funcionalidade em desenvolvimento`);
      }

      function deleteVideo(videoId) {
        // Redirecionar para a função principal de exclusão
        excluirVideo(videoId);
      }

      // Função para visualizar vídeo
      function viewVideo(videoId) {
        // Dados dos vídeos (simulados - em produção viria do banco de dados)
        const videos = {
          1: {
            title: "Treino de Natação - Ana Mendonça",
            description: "Sessão de treinamento focada em técnica de nado livre e resistência. Ana demonstra excelente progresso na técnica de respiração lateral.",
            url: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_1mb.mp4", // URL de exemplo
            date: "Postado há 2 dias",
            athlete: "Ana Mendonça"
          },
          2: {
            title: "Análise Técnica - Pedro Silva",
            description: "Análise detalhada da técnica de corrida de Pedro, focando na biomecânica e eficiência do movimento.",
            url: "https://sample-videos.com/zip/10/mp4/SampleVideo_1280x720_2mb.mp4", // URL de exemplo
            date: "Postado há 1 semana",
            athlete: "Pedro Silva"
          }
        };

        const video = videos[videoId];
        if (video) {
          // Atualizar o modal com os dados do vídeo
          document.getElementById('videoViewTitle').textContent = video.title;
          document.getElementById('videoViewDetailsTitle').textContent = video.title;
          document.getElementById('videoViewDescription').textContent = video.description;
          document.getElementById('videoViewDate').textContent = video.date;
          document.getElementById('videoViewAthlete').textContent = video.athlete;
          
          // Configurar o player de vídeo
          const videoSource = document.getElementById('videoSource');
          const videoPlayer = document.getElementById('videoPlayer');
          
          videoSource.src = video.url;
          videoPlayer.load(); // Recarregar o vídeo com a nova fonte
          
          // Mostrar o modal
          document.getElementById('videoViewModal').style.display = 'block';
        } else {
          alert('Vídeo não encontrado!');
        }
      }

      // Função para fechar o modal de visualização de vídeo
      function closeVideoViewModal() {
        document.getElementById('videoViewModal').style.display = 'none';
        // Pausar o vídeo quando fechar o modal
        const videoPlayer = document.getElementById('videoPlayer');
        videoPlayer.pause();
        videoPlayer.currentTime = 0;
      }

      // Event listener para fechar modal ao clicar fora dele
      window.onclick = function(event) {
        const videoModal = document.getElementById('videoViewModal');
        if (event.target === videoModal) {
          closeVideoViewModal();
        }
      }

      // Event listener para o formulário de vídeo
      document.getElementById("videoForm").addEventListener("submit", async function(e) {
        e.preventDefault();
        
        const title = document.getElementById('videoTitle').value;
        const description = document.getElementById('videoDescription').value;
        const file = document.getElementById('videoFile').files[0];
        const athlete = document.getElementById('videoAthlete').value;
        
        if (!title || !file) {
          alert('Por favor, preencha o título e selecione um arquivo de vídeo.');
          return;
        }
        
        if (!athlete) {
          alert('Por favor, selecione um atleta.');
          return;
        }
        
        try {
          // Usar diretamente o ID do atleta (já vem do select)
          const atletaId = parseInt(athlete);
          
          if (!atletaId || atletaId < 1 || atletaId > 5) {
            alert('Atleta não encontrado.');
            return;
          }
          
          // Arquivo validado com sucesso
          
          // Verificar tipo de arquivo
          const allowedTypes = ['video/mp4', 'video/avi', 'video/mov', 'video/wmv', 'video/flv', 'video/webm'];
          if (!allowedTypes.includes(file.type)) {
            alert('Tipo de arquivo não permitido. Use: MP4, AVI, MOV, WMV, FLV, WEBM');
            return;
          }
          
          // Criar FormData para enviar o arquivo
          const formData = new FormData();
          formData.append('video_file', file);
          formData.append('atleta_id', atletaId);
          formData.append('titulo', title);
          formData.append('descricao', description);
          formData.append('tipo_video', 'treino');
          
          // Enviar dados para a API
          const token = localStorage.getItem('jwt_token');
          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          
          console.log('🎥 [UPLOAD] Enviando vídeo:', {
            titulo: title,
            atleta_id: atletaId,
            arquivo: file.name,
            tamanho: file.size
          });
          
          const response = await fetch(`${baseURL}/api/treinador/videos`, {
            method: 'POST',
            headers: {
              'Authorization': `Bearer ${token}`
              // Não definir Content-Type para FormData
            },
            body: formData
          });
          
          const data = await response.json();
          
          if (data.sucesso) {
        alert(`Vídeo "${title}" postado com sucesso!`);
        document.getElementById("videoModal").style.display = "none";
        document.getElementById("videoForm").reset();
            
            // Recarregar lista de vídeos se estiver visível
            if (document.getElementById("videosList").style.display !== "none") {
              carregarListaVideos();
            }
          } else {
            alert(`Erro ao postar vídeo: ${data.erro}`);
          }
          
        } catch (error) {
          console.error('Erro ao postar vídeo:', error);
          alert('Erro ao postar vídeo. Tente novamente.');
        }
        
        // Resetar visualizações
        document.getElementById("videosList").style.display = "none";
        document.getElementById("uploadVideo").style.display = "none";
      });

      // =====================================================
      // FUNÇÕES PARA COMPETIÇÕES DINÂMICAS
      // =====================================================

      // Função para carregar competições do banco de dados
      async function carregarCompeticoes() {
        try {
          console.log('🔄 [DASHBOARD] Carregando competições...');
          
          const token = localStorage.getItem('jwt_token');
          if (!token) {
            console.log('⚠️ [DASHBOARD] Nenhum token encontrado');
            return;
          }

          const baseURL = window.location.protocol === 'file:' ? 'http://localhost:5000' : '';
          const response = await fetch(`${baseURL}/api/eventos/proximos`, {
            headers: {
              'Authorization': `Bearer ${token}`,
              'Content-Type': 'application/json'
            }
          });

          if (!response.ok) {
            throw new Error(`Erro ${response.status}: ${response.statusText}`);
          }

          const dados = await response.json();
          console.log('✅ [DASHBOARD] Resposta completa:', dados);
          console.log('✅ [DASHBOARD] Eventos encontrados:', dados.eventos);
          
          renderizarCompeticoes(dados.eventos);
          
        } catch (error) {
          console.error('❌ [DASHBOARD] Erro ao carregar competições:', error);
          mostrarErroCompeticoes();
        }
      }

      // Função para renderizar competições
      function renderizarCompeticoes(competicoes) {
        const container = document.getElementById('competitions-container');
        
        if (!competicoes || competicoes.length === 0) {
          container.innerHTML = `
            <div class="no-competitions">
              <i class="fas fa-calendar-times"></i>
              <p>Nenhuma competição agendada</p>
              <small>Adicione eventos no calendário para vê-los aqui</small>
            </div>
          `;
          return;
        }

        let html = '';
        competicoes.forEach(competicao => {
          // Usar data exata do sistema (sem conversões)
          const dataOriginal = competicao.data_evento;
          const data = usarDataExata(competicao.data_evento);
          const dia = data.getDate();
          const mes = data.toLocaleString('pt-BR', { month: 'short' }).toUpperCase();
          const hora = competicao.hora_evento || '--:--';
          const local = competicao.local || 'Local não informado';
          
          // Log para debug das datas
          console.log('📅 [DEBUG] Data do evento:', {
            original: dataOriginal,
            processada: data.toISOString(),
            dia: dia,
            mes: mes,
            titulo: competicao.titulo,
            dataCompleta: data.toLocaleDateString('pt-BR'),
            horaLocal: data.toLocaleTimeString('pt-BR'),
            timestamp: data.getTime(),
            dataUTC: data.toUTCString()
          });
          
          // Determinar o tipo de evento para exibição
          let tipoExibicao = '';
          switch(competicao.tipo_evento) {
            case 'competicao':
              tipoExibicao = '🏆';
              break;
            case 'treinamento':
              tipoExibicao = '🏃';
              break;
            case 'reuniao':
              tipoExibicao = '📋';
              break;
            default:
              tipoExibicao = '📅';
          }
          
          html += `
            <div class="competition-item">
              <div class="competition-date">
                <div class="day">${dia}</div>
                <div class="month">${mes}</div>
              </div>
              <div class="competition-details">
                <h4>${tipoExibicao} ${competicao.titulo}</h4>
                <p>${local} - ${hora}</p>
              </div>
            </div>
          `;
        });
        
        container.innerHTML = html;
      }

      // Função para mostrar erro ao carregar competições
      function mostrarErroCompeticoes() {
        const container = document.getElementById('competitions-container');
        container.innerHTML = `
          <div class="no-competitions">
            <i class="fas fa-exclamation-triangle"></i>
            <p>Erro ao carregar competições</p>
            <small>Tente recarregar a página</small>
          </div>
        `;
      }

             // Carregar competições quando a página carregar
       document.addEventListener('DOMContentLoaded', function() {
         console.log('🚀 [DASHBOARD] DOM carregado, carregando competições...');
         carregarCompeticoes();
       });

      // Função para atualizar competições em tempo real
      function atualizarCompeticoes() {
        carregarCompeticoes();
      }

      // Expor função globalmente
      window.atualizarCompeticoes = atualizarCompeticoes;
      
      // Função para testar processamento de datas
      function testarProcessamentoDatas() {
        console.log('🧪 [TESTE] Testando processamento de datas...');
        
        const datasTeste = ['2024-12-06', '2024-12-05', '2024-12-07'];
        
        datasTeste.forEach(data => {
          const dataProcessada = usarDataExata(data);
          console.log('🧪 [TESTE] Data:', data, '→ Processada:', {
            original: data,
            processada: dataProcessada.toISOString(),
            dia: dataProcessada.getDate(),
            mes: dataProcessada.getMonth() + 1,
            ano: dataProcessada.getFullYear(),
            timestamp: dataProcessada.getTime(),
            dataLocal: dataProcessada.toLocaleDateString('pt-BR')
          });
        });
      }
      
      // Expor função de teste
      window.testarProcessamentoDatas = testarProcessamentoDatas;
      
      // Inicializar sistemas
      document.addEventListener('DOMContentLoaded', function() {
        // Inicializar sistema de idiomas
        if (typeof SistemaIdiomas !== 'undefined') {
          window.sistemaIdiomas = new SistemaIdiomas();
          console.log('✅ Sistema de idiomas inicializado no dashboard do treinador');
        } else {
          console.log('⚠️ Classe SistemaIdiomas não encontrada');
        }
        
        // Inicializar sistema de notificações
        if (typeof SistemaNotificacoes !== 'undefined') {
          window.sistemaNotificacoes = new SistemaNotificacoes();
          console.log('✅ Sistema de notificações inicializado no dashboard do treinador');
        } else {
          console.log('⚠️ Classe SistemaNotificacoes não encontrada');
        }
      });
    </script>
  </body>
</html>
